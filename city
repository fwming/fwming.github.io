[1mdiff --git a/dist/controller/edm/editHarbourCity.js b/dist/controller/edm/editHarbourCity.js[m
[1mnew file mode 100644[m
[1mindex 0000000..1d3be44[m
[1m--- /dev/null[m
[1m+++ b/dist/controller/edm/editHarbourCity.js[m
[36m@@ -0,0 +1,390 @@[m
[32m+[m[32m(function() {[m
[32m+[m	[32mlayui.use(['layer', 'layedit', 'form', 'copy'],	function() {[m
[32m+[m		[32mvar layer = layui.layer,[m
[32m+[m[32m            form = layui.form,[m
[32m+[m[32m            copy = layui.copy,[m
[32m+[m[32m            layedit = layui.layedit;[m
[32m+[m
[32m+[m[32m        // 获取编辑模式盒子[m
[32m+[m[32m        var $_edit_en = $('.edit_en');[m
[32m+[m[32m        var $_edit_tc = $('.edit_tc');[m
[32m+[m[32m        var $_edit_sc = $('.edit_sc');[m
[32m+[m
[32m+[m[32m        // 获取预览模式盒子[m
[32m+[m[32m        var $_look_en = $('#en');[m
[32m+[m[32m        var $_look_tc = $('#tc');[m
[32m+[m[32m        var $_look_sc = $('#sc');[m
[32m+[m
[32m+[m[32m        // 图片路径[m
[32m+[m[32m        var imgUrl = '';[m
[32m+[m[32m        // 保存加载图片名称[m
[32m+[m[32m        var imgArr = [];[m
[32m+[m
[32m+[m[32m        // 自动填充时间[m
[32m+[m[32m        var data = new Date();[m
[32m+[m[32m        var y = data.getFullYear();[m
[32m+[m[32m        var m = data.getMonth() + 1;[m
[32m+[m[32m        var d = data.getDate();[m
[32m+[m[32m        if(d > 15){[m
[32m+[m[32m            m++;[m
[32m+[m[32m            d = '1';[m
[32m+[m[32m        }else{[m
[32m+[m[32m            d = '15';[m
[32m+[m[32m        }[m
[32m+[m[32m        $('.startTime').val(d+'.'+m+'.'+y);[m
[32m+[m
[32m+[m[32m        // 储存获取到的Excel数据[m
[32m+[m[32m        var excel_datas = {};[m
[32m+[m
[32m+[m[32m        // 获取版本--默认Normal[m
[32m+[m[32m        var EDM_Version = 'Normal';[m
[32m+[m[32m        form.render();[m
[32m+[m[32m        form.on('radio(version)', function(data){[m
[32m+[m[32m            EDM_Version = data.value;[m
[32m+[m[32m            console.log('版本：' + EDM_Version);[m
[32m+[m[32m        });[m
[32m+[m[41m        [m
[32m+[m		[32mlayedit.set({[m
[32m+[m			[32m//开发者模式 --默认为false[m
[32m+[m			[32mdevmode: true,[m
[32m+[m			[32m//插入代码设置[m
[32m+[m			[32mcodeConfig: {[m
[32m+[m				[32m//hide: true,  //是否显示编码语言选择框[m
[32m+[m				[32m//default: 'HTML' //hide为true时的默认语言格式[m
[32m+[m			[32m},[m
[32m+[m			[32mtool: [[m
[32m+[m				[32m'html', 'code', 'strong', 'italic', 'underline', 'del', 'addhr', '|',[m[41m [m
[32m+[m				[32m'fontFomatt', 'fontfamily', 'fontSize', 'colorpicker', 'fontBackColor', 'face', '|',[m[41m [m
[32m+[m				[32m'left', 'center', 'right', '|', 'link', 'unlink', 'images', 'image_alt', 'video', 'anchors', '|',[m[41m [m
[32m+[m				[32m'table', 'preview', 'help',[m
[32m+[m			[32m],[m
[32m+[m			[32mheight: '578'[m
[32m+[m		[32m});[m
[32m+[m
[32m+[m[32m        // 编辑器初始化[m
[32m+[m		[32mvar index_en = layedit.build('en');[m
[32m+[m		[32mvar index_tc = layedit.build('tc');[m
[32m+[m		[32mvar index_sc = layedit.build('sc');[m
[32m+[m
[32m+[m[32m        // 同步编辑模式与微调模式[m
[32m+[m[32m        function Synchronize(){[m
[32m+[m[32m            layedit.setContent(index_en, $_edit_en.html(), false);[m
[32m+[m[32m            layedit.setContent(index_tc, $_edit_tc.html(), false);[m
[32m+[m[32m            layedit.setContent(index_sc, $_edit_sc.html(), false);[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        // 导入Excel文件[m
[32m+[m[32m        $('.load-file-btn').click(function(){[m
[32m+[m[32m            $('#load-file').click();[m
[32m+[m[32m        })[m
[32m+[m[32m        // 读取excel数据[m
[32m+[m[32m        $('#load-file').change(function() {[m
[32m+[m[32m            // 获取传递过来的内容[m
[32m+[m[32m            let file = this.files[0];[m
[32m+[m[32m            console.log(file);[m
[32m+[m[32m            // 创建 FileReader 示例[m
[32m+[m[32m            let showPreview = new FileReader();[m
[32m+[m[32m            // 读取文件[m
[32m+[m[32m            showPreview.readAsBinaryString(file)[m
[32m+[m[32m            // 文件读取成功时的回调函数[m
[32m+[m[32m            showPreview.onload = (e) => {[m
[32m+[m[32m                // 获取传递的表格[m
[32m+[m[32m                let data = e.target.result[m
[32m+[m[32m                // 以二进制流方式读取到整份的excel 表格对象[m
[32m+[m[32m                let workbook = XLSX.read(data, {[m
[32m+[m[32m                    type: 'binary'[m
[32m+[m[32m                })[m
[32m+[m[32m                // 表格的表格范围，可用于判断表头是否数量是否正确[m
[32m+[m[32m                let fromTo = '';[m
[32m+[m[32m                console.log(fromTo);[m
[32m+[m[32m                // 遍历每张表读取[m
[32m+[m[32m                for (var sheet in workbook.Sheets) {[m
[32m+[m[32m                    persons = [];[m
[32m+[m[32m                    // 判断文件是否是 excel 文件[m
[32m+[m[32m                    if (workbook.Sheets.hasOwnProperty(sheet)) {[m
[32m+[m[32m                        // 对表格的内容进行处理[m
[32m+[m[32m                        persons = persons.concat(XLSX.utils.sheet_to_json(workbook.Sheets[sheet]));[m
[32m+[m[32m                        excel_datas[sheet] = persons;[m
[32m+[m[32m                        // 如果只取第一张表，就取消注释这行[m
[32m+[m[32m                        // break;[m
[32m+[m[32m                    }[m
[32m+[m[32m                }[m
[32m+[m[32m                console.log(excel_datas);[m
[32m+[m[32m            }[m
[32m+[m[32m        });[m
[32m+[m
[32m+[m[32m        // 上传图片[m
[32m+[m		[32m$('.load-img-btn').click(function(){[m[41m            [m
[32m+[m[32m            // 图片路径[m
[32m+[m[32m            imgUrl = $('.imgUrl').val().trim();[m
[32m+[m[32m            if(!/.\/$/.test(imgUrl)){[m
[32m+[m[32m                $('.imgUrl').css({'border-color': 'red'});[m
[32m+[m[32m                layer.msg("请填写图片路径前缀,以'/'结束");[m
[32m+[m[32m            }else{[m
[32m+[m[32m                $('.imgUrl').css({'border-color': '#e6e6e6'});[m
[32m+[m[32m                $('#load-img').click();[m
[32m+[m[32m            }[m
[32m+[m		[32m});[m
[32m+[m		[32m$('#load-img').change(function() {[m
[32m+[m[32m            imgArr = [];[m
[32m+[m			[32mvar files = document.getElementById('load-img').files;[m
[32m+[m[32m            console.log(files);[m
[32m+[m[32m            for(var i = 0; i < files.length; i++){[m
[32m+[m[32m                imgArr.push(imgUrl + files[i].name);[m
[32m+[m[32m            }[m
[32m+[m		[32m});[m
[32m+[m
[32m+[m[32m        // 一键生成[m
[32m+[m[32m        $('.create-edm-btn').click(function(){[m
[32m+[m[32m            if(imgArr.length>0 && excel_datas){[m
[32m+[m[32m                console.time('CreateEDM');[m
[32m+[m[32m                CreateEDM(excel_datas);[m
[32m+[m[32m                console.timeEnd('CreateEDM');[m
[32m+[m[32m            }else{[m
[32m+[m[32m                layer.msg('请先上传文件和图片');[m
[32m+[m[32m            }[m
[32m+[m[32m        })[m
[32m+[m
[32m+[m[32m        // 同步模式[m
[32m+[m[32m        $('.save-btn').click(function(){[m
[32m+[m[32m            layer.msg("同步成功");[m
[32m+[m[32m            Synchronize();[m
[32m+[m[32m        })[m
[32m+[m
[32m+[m[32m        // 复制代码[m
[32m+[m		[32m$('.copy-code').click(function() {[m
[32m+[m			[32mvar code = $('.look').html();[m
[32m+[m			[32mcopy.copyFn(code)[m
[32m+[m		[32m})[m
[32m+[m
[32m+[m[32m        // 创建EDM函数[m
[32m+[m[32m        function CreateEDM(resource){[m
[32m+[m[32m            // 图片下标[m
[32m+[m[32m            var imgIndex = 0;[m
[32m+[m[32m            // 开始时间[m
[32m+[m[32m            var startTime = $('.startTime').val().trim();[m
[32m+[m[32m            // 小标题[m
[32m+[m[32m            var en_preSubject = $('.en_preSubject').val().trim();[m
[32m+[m[32m            var tc_preSubject = $('.tc_preSubject').val().trim();[m
[32m+[m[32m            var sc_preSubject = $('.sc_preSubject').val().trim();[m
[32m+[m[32m            // 整体结构[m
[32m+[m[32m            var en_layout = '';[m
[32m+[m[32m            var tc_layout = '';[m
[32m+[m[32m            var sc_layout = '';[m
[32m+[m[32m            // 动态资源[m
[32m+[m[32m            var en_Exclusive_Highlight = '';[m
[32m+[m[32m            var tc_Exclusive_Highlight = '';[m
[32m+[m[32m            var sc_Exclusive_Highlight = '';[m
[32m+[m[32m            var en_Event_Highlight = '';[m
[32m+[m[32m            var tc_Event_Highlight = '';[m
[32m+[m[32m            var sc_Event_Highlight = '';[m
[32m+[m[32m            var en_Exclusive = '';[m
[32m+[m[32m            var tc_Exclusive = '';[m
[32m+[m[32m            var sc_Exclusive = '';[m
[32m+[m[32m            var en_All_Tier = '';[m
[32m+[m[32m            var tc_All_Tier = '';[m
[32m+[m[32m            var sc_All_Tier = '';[m
[32m+[m
[32m+[m[32m            // 静态资源[m
[32m+[m[32m            var en_style = '';[m
[32m+[m[32m            var tc_style = '';[m
[32m+[m[32m            var sc_style = '';[m
[32m+[m[32m            var en_header = '';[m
[32m+[m[32m            var tc_header = '';[m
[32m+[m[32m            var sc_header = '';[m
[32m+[m[32m            var en_gift1 = '';[m
[32m+[m[32m            var tc_gift1 = '';[m
[32m+[m[32m            var sc_gift1 = '';[m
[32m+[m[32m            var en_gift2 = '';[m
[32m+[m[32m            var tc_gift2 = '';[m
[32m+[m[32m            var sc_gift2 = '';[m
[32m+[m[32m            var en_footer = '';[m
[32m+[m[32m            var tc_footer = '';[m
[32m+[m[32m            var sc_footer = '';[m
[32m+[m[32m            var line = '';[m
[32m+[m[32m            var space = '';[m
[32m+[m[32m            var en_exclusiveHeader = '';[m
[32m+[m[32m            var tc_exclusiveHeader = '';[m
[32m+[m[32m            var sc_exclusiveHeader = '';[m
[32m+[m[32m            var en_eventHeader = '';[m
[32m+[m[32m            var tc_eventHeader = '';[m
[32m+[m[32m            var sc_eventHeader = '';[m
[32m+[m[32m            var en_hasLogo = '';[m
[32m+[m[32m            var tc_hasLogo = '';[m
[32m+[m[32m            var sc_hasLogo = '';[m
[32m+[m[32m            var en_noLogo = '';[m
[32m+[m[32m            var tc_noLogo = '';[m
[32m+[m[32m            var sc_noLogo = '';[m
[32m+[m[32m            var en_imgText = '';[m
[32m+[m[32m            var tc_imgText = '';[m
[32m+[m[32m            var sc_imgText = '';[m
[32m+[m
[32m+[m[41m            [m
[32m+[m[32m            // 获取静态资源[m
[32m+[m[32m            $.ajax({[m
[32m+[m				[32mtype: "get",[m
[32m+[m				[32murl: "./dist/views/conventional/tool/harbourCity/template.html",[m
[32m+[m				[32masync: false,[m
[32m+[m				[32mdataType: 'html',[m
[32m+[m				[32msuccess: function(e) {[m
[32m+[m[32m                    en_style = e.split('<!-- style -->')[1].split('<!-- en -->')[1];[m
[32m+[m[32m                    tc_style = e.split('<!-- style -->')[1].split('<!-- tc -->')[1];[m
[32m+[m[32m                    sc_style = e.split('<!-- style -->')[1].split('<!-- sc -->')[1];[m
[32m+[m[32m                    EDM_Version == 'Normal'? versionBg = '#BAA79C' : versionBg = '#666666';[m
[32m+[m[32m                    en_header = e.split('<!-- header -->')[1].split('<!-- en -->')[1].replace('$_startTime', startTime).replace('$_preSubject', en_preSubject).replace('$_versionBg',versionBg);[m
[32m+[m[32m                    tc_header = e.split('<!-- header -->')[1].split('<!-- tc -->')[1].replace('$_startTime', startTime).replace('$_preSubject', tc_preSubject).replace('$_versionBg',versionBg);[m
[32m+[m[32m                    sc_header = e.split('<!-- header -->')[1].split('<!-- sc -->')[1].replace('$_startTime', startTime).replace('$_preSubject', sc_preSubject).replace('$_versionBg',versionBg);[m
[32m+[m[32m                    en_gift1 = e.split('<!-- gift1 -->')[1].split('<!-- en -->')[1];[m
[32m+[m[32m                    tc_gift1 = e.split('<!-- gift1 -->')[1].split('<!-- tc -->')[1];[m
[32m+[m[32m                    sc_gift1 = e.split('<!-- gift1 -->')[1].split('<!-- sc -->')[1];[m
[32m+[m[32m                    en_gift2 = e.split('<!-- gift2 -->')[1].split('<!-- en -->')[1];[m
[32m+[m[32m                    tc_gift2 = e.split('<!-- gift2 -->')[1].split('<!-- tc -->')[1];[m
[32m+[m[32m                    sc_gift2 = e.split('<!-- gift2 -->')[1].split('<!-- sc -->')[1];[m
[32m+[m[32m                    en_footer = e.split('<!-- footer -->')[1].split('<!-- en -->')[1].replace('$_remarks',resource.Remarks[0].Remarks_EN.replace(/\n/g, '<br>'));[m
[32m+[m[32m                    tc_footer = e.split('<!-- footer -->')[1].split('<!-- tc -->')[1].replace('$_remarks',resource.Remarks[0].Remarks_TC.replace(/\n/g, '<br>'));[m
[32m+[m[32m                    sc_footer = e.split('<!-- footer -->')[1].split('<!-- sc -->')[1].replace('$_remarks',resource.Remarks[0].Remarks_SC.replace(/\n/g, '<br>'));[m
[32m+[m[32m                    line = e.split('<!-- line -->')[1];[m
[32m+[m[32m                    space = e.split('<!-- space -->')[1];[m
[32m+[m
[32m+[m[32m                    en_exclusiveHeader = e.split('<!-- exclusiveHeader -->')[1].split('<!-- en -->')[1];[m
[32m+[m[32m                    tc_exclusiveHeader = e.split('<!-- exclusiveHeader -->')[1].split('<!-- tc -->')[1];[m
[32m+[m[32m                    sc_exclusiveHeader = e.split('<!-- exclusiveHeader -->')[1].split('<!-- sc -->')[1];[m
[32m+[m[32m                    en_eventHeader = e.split('<!-- eventHeader -->')[1].split('<!-- en -->')[1];[m
[32m+[m[32m                    tc_eventHeader = e.split('<!-- eventHeader -->')[1].split('<!-- tc -->')[1];[m
[32m+[m[32m                    sc_eventHeader = e.split('<!-- eventHeader -->')[1].split('<!-- sc -->')[1];[m
[32m+[m[32m                    en_hasLogo = e.split('<!-- hasLogo -->')[1].split('<!-- en -->')[1];[m
[32m+[m[32m                    tc_hasLogo = e.split('<!-- hasLogo -->')[1].split('<!-- tc -->')[1];[m
[32m+[m[32m                    sc_hasLogo = e.split('<!-- hasLogo -->')[1].split('<!-- sc -->')[1];[m
[32m+[m[32m                    en_noLogo = e.split('<!-- noLogo -->')[1].split('<!-- en -->')[1];[m
[32m+[m[32m                    tc_noLogo = e.split('<!-- noLogo -->')[1].split('<!-- tc -->')[1];[m
[32m+[m[32m                    sc_noLogo = e.split('<!-- noLogo -->')[1].split('<!-- sc -->')[1];[m
[32m+[m[32m                    en_imgText = e.split('<!-- imgText -->')[1].split('<!-- en -->')[1];[m
[32m+[m[32m                    tc_imgText = e.split('<!-- imgText -->')[1].split('<!-- tc -->')[1];[m
[32m+[m[32m                    sc_imgText = e.split('<!-- imgText -->')[1].split('<!-- sc -->')[1];[m
[32m+[m
[32m+[m
[32m+[m[32m                    // Exclusive_Highlight[m
[32m+[m[32m                    var isHasHeader_Exclusive_Highlight = 0;[m
[32m+[m[32m                    if(resource.Exclusive_Highlight.length){[m
[32m+[m[32m                        for(var i = 0; i < resource.Exclusive_Highlight.length; i++){[m
[32m+[m[32m                            if(!(EDM_Version == 'Shui' && resource.Exclusive_Highlight[i].BelongTo_Shui == 'no')){[m
[32m+[m[32m                                isHasHeader_Exclusive_Highlight++;[m
[32m+[m[32m                                if(isHasHeader_Exclusive_Highlight == 1){[m
[32m+[m[32m                                    en_Exclusive_Highlight += en_exclusiveHeader;[m
[32m+[m[32m                                    tc_Exclusive_Highlight += tc_exclusiveHeader;[m
[32m+[m[32m                                    sc_Exclusive_Highlight += sc_exclusiveHeader;[m
[32m+[m[32m                                }[m
[32m+[m[32m                                if(resource.Exclusive_Highlight[i].Has_logo == 'yes'){[m
[32m+[m[32m                                    en_Exclusive_Highlight += en_hasLogo.replace('$_bannerImgSrc', imgArr[imgIndex]).replace('$_logoImgSrc', imgArr[(imgIndex+1)]).replace('$_dynamicText', resource.Exclusive_Highlight[i].Offer_EN.replace(/\n/g, '<br>'));[m
[32m+[m[32m                                    tc_Exclusive_Highlight += tc_hasLogo.replace('$_bannerImgSrc', imgArr[imgIndex]).replace('$_logoImgSrc', imgArr[(imgIndex+1)]).replace('$_dynamicText', resource.Exclusive_Highlight[i].Offer_TC.replace(/\n/g, '<br>'));[m
[32m+[m[32m                                    sc_Exclusive_Highlight += sc_hasLogo.replace('$_bannerImgSrc', imgArr[imgIndex]).replace('$_logoImgSrc', imgArr[(imgIndex+1)]).replace('$_dynamicText', resource.Exclusive_Highlight[i].Offer_SC.replace(/\n/g, '<br>'));[m
[32m+[m[41m                                    [m
[32m+[m[32m                                    imgIndex += 2;[m
[32m+[m[32m                                }else{[m
[32m+[m[32m                                    en_Exclusive_Highlight += en_noLogo.replace('$_bannerImgSrc', imgArr[imgIndex]).replace('$_dynamicText', resource.Exclusive_Highlight[i].Offer_EN.replace(/\n/g, '<br>'));[m
[32m+[m[32m                                    tc_Exclusive_Highlight += tc_noLogo.replace('$_bannerImgSrc', imgArr[imgIndex]).replace('$_dynamicText', resource.Exclusive_Highlight[i].Offer_TC.replace(/\n/g, '<br>'));[m
[32m+[m[32m                                    sc_Exclusive_Highlight += sc_noLogo.replace('$_bannerImgSrc', imgArr[imgIndex]).replace('$_dynamicText', resource.Exclusive_Highlight[i].Offer_SC.replace(/\n/g, '<br>'));[m
[32m+[m
[32m+[m[32m                                    imgIndex++;[m
[32m+[m[32m                                }[m
[32m+[m[32m                                // 加分割线[m
[32m+[m[32m                                if(i < resource.Exclusive_Highlight.length - 1){[m
[32m+[m[32m                                    en_Exclusive_Highlight += line;[m
[32m+[m[32m                                    tc_Exclusive_Highlight += line;[m
[32m+[m[32m                                    sc_Exclusive_Highlight += line;[m
[32m+[m[32m                                }[m
[32m+[m
[32m+[m[32m                            }[m
[32m+[m[32m                        }[m
[32m+[m[32m                        // 末尾加空白间隔[m
[32m+[m[32m                        if(isHasHeader_Exclusive_Highlight){[m
[32m+[m[32m                            en_Exclusive_Highlight += space;[m
[32m+[m[32m                            tc_Exclusive_Highlight += space;[m
[32m+[m[32m                            sc_Exclusive_Highlight += space;[m
[32m+[m[32m                        }[m
[32m+[m[32m                    }[m
[32m+[m
[32m+[m[32m                    // Event_Highlight[m
[32m+[m[32m                    var isHasHeader_Event_Highlight = 0;[m
[32m+[m[32m                    if(resource.Event_Highlight.length){[m
[32m+[m[32m                        for(var i = 0; i < resource.Event_Highlight.length; i++){[m
[32m+[m[32m                            if(!(EDM_Version == 'Shui' && resource.Event_Highlight[i].BelongTo_Shui == 'no')){[m
[32m+[m[32m                                isHasHeader_Event_Highlight++;[m
[32m+[m[32m                                if(isHasHeader_Event_Highlight == 1){[m
[32m+[m[32m                                    en_Event_Highlight += en_eventHeader;[m
[32m+[m[32m                                    tc_Event_Highlight += tc_eventHeader;[m
[32m+[m[32m                                    sc_Event_Highlight += sc_eventHeader;[m
[32m+[m[32m                                }[m[41m                                [m
[32m+[m[32m                                if(resource.Event_Highlight[i].Has_logo == 'yes'){[m
[32m+[m[32m                                    en_Event_Highlight += en_hasLogo.replace('$_bannerImgSrc', imgArr[imgIndex]).replace('$_logoImgSrc', imgArr[(imgIndex+1)]).replace('$_dynamicText', resource.Event_Highlight[i].Offer_EN.replace(/\n/g, '<br>'));[m
[32m+[m[32m                                    tc_Event_Highlight += tc_hasLogo.replace('$_bannerImgSrc', imgArr[imgIndex]).replace('$_logoImgSrc', imgArr[(imgIndex+1)]).replace('$_dynamicText', resource.Event_Highlight[i].Offer_TC.replace(/\n/g, '<br>'));[m
[32m+[m[32m                                    sc_Event_Highlight += sc_hasLogo.replace('$_bannerImgSrc', imgArr[imgIndex]).replace('$_logoImgSrc', imgArr[(imgIndex+1)]).replace('$_dynamicText', resource.Event_Highlight[i].Offer_SC.replace(/\n/g, '<br>'));[m
[32m+[m
[32m+[m[32m                                    imgIndex += 2;[m
[32m+[m[32m                                }else{[m
[32m+[m[32m                                    en_Event_Highlight += en_noLogo.replace('$_bannerImgSrc', imgArr[imgIndex]).replace('$_dynamicText', resource.Event_Highlight[i].Offer_EN.replace(/\n/g, '<br>'));[m
[32m+[m[32m                                    tc_Event_Highlight += tc_noLogo.replace('$_bannerImgSrc', imgArr[imgIndex]).replace('$_dynamicText', resource.Event_Highlight[i].Offer_TC.replace(/\n/g, '<br>'));[m
[32m+[m[32m                                    sc_Event_Highlight += sc_noLogo.replace('$_bannerImgSrc', imgArr[imgIndex]).replace('$_dynamicText', resource.Event_Highlight[i].Offer_SC.replace(/\n/g, '<br>'));[m
[32m+[m
[32m+[m[32m                                    imgIndex++;[m
[32m+[m[32m                                }[m
[32m+[m[32m                                // 加分割线[m
[32m+[m[32m                                if(i < resource.Event_Highlight.length - 1){[m
[32m+[m[32m                                    en_Event_Highlight += line;[m
[32m+[m[32m                                    tc_Event_Highlight += line;[m
[32m+[m[32m                                    sc_Event_Highlight += line;[m
[32m+[m[32m                                }[m
[32m+[m[32m                            }[m
[32m+[m[32m                        }[m
[32m+[m[32m                        // 末尾加空白间隔[m
[32m+[m[32m                        if(isHasHeader_Event_Highlight){[m
[32m+[m[32m                            en_Event_Highlight += space;[m
[32m+[m[32m                            tc_Event_Highlight += space;[m
[32m+[m[32m                            sc_Event_Highlight += space;[m
[32m+[m[32m                        }[m
[32m+[m[32m                    }[m
[32m+[m
[32m+[m[32m                    // Exclusive[m
[32m+[m[32m                    if(resource.Exclusive){[m
[32m+[m[32m                        var itemDir = 'dir="ltr"';[m
[32m+[m[32m                        for(var i = 0; i < resource.Exclusive.length; i++){[m
[32m+[m[32m                            i % 2 ? itemDir = 'dir="ltr"' : itemDir = 'dir="rtl"';[m
[32m+[m[32m                            EDM_Version == 'Normal' ? Points = resource.Exclusive[i].Points_Normal : Points = resource.Exclusive[i].Points_Shui;[m
[32m+[m[32m                            en_Exclusive += en_imgText.replace('$_itemDir', itemDir).replace('$_itemImgSrc', imgArr[imgIndex]).replace('$_itemTitle', resource.Exclusive[i].Brand).replace('$_itemText', resource.Exclusive[i].Items_EN).replace('$_itemRemarks', resource.Exclusive[i].Remarks).replace('$_itemDate', resource.Exclusive[i].Redemption_Date).replace('$_itemPoints', Points).replace('$_itemQty', resource.Exclusive[i].QTY);[m
[32m+[m[32m                            tc_Exclusive += tc_imgText.replace('$_itemDir', itemDir).replace('$_itemImgSrc', imgArr[imgIndex]).replace('$_itemTitle', resource.Exclusive[i].Brand).replace('$_itemText', resource.Exclusive[i].Items_TC).replace('$_itemRemarks', resource.Exclusive[i].Remarks).replace('$_itemDate', resource.Exclusive[i].Redemption_Date).replace('$_itemPoints', Points).replace('$_itemQty', resource.Exclusive[i].QTY);[m
[32m+[m[32m                            sc_Exclusive += sc_imgText.replace('$_itemDir', itemDir).replace('$_itemImgSrc', imgArr[imgIndex]).replace('$_itemTitle', resource.Exclusive[i].Brand).replace('$_itemText', resource.Exclusive[i].Items_SC).replace('$_itemRemarks', resource.Exclusive[i].Remarks).replace('$_itemDate', resource.Exclusive[i].Redemption_Date).replace('$_itemPoints', Points).replace('$_itemQty', resource.Exclusive[i].QTY);[m
[32m+[m[32m                            imgIndex++;[m
[32m+[m[32m                        }[m
[32m+[m[32m                    }[m
[32m+[m
[32m+[m[32m                    // All_Tier[m
[32m+[m[32m                    if(resource.All_Tier){[m
[32m+[m[32m                        var itemDir = 'dir="ltr"';[m
[32m+[m[32m                        for(var i = 0; i < resource.All_Tier.length; i++){[m
[32m+[m[32m                            i % 2 ? itemDir = 'dir="ltr"' : itemDir = 'dir="rtl"';[m
[32m+[m[32m                            EDM_Version == 'Normal' ? Points = resource.All_Tier[i].Points_Normal : Points = resource.All_Tier[i].Points_Shui;[m
[32m+[m[32m                            en_All_Tier += en_imgText.replace('$_itemDir', itemDir).replace('$_itemImgSrc', imgArr[imgIndex]).replace('$_itemTitle', resource.All_Tier[i].Brand).replace('$_itemText', resource.All_Tier[i].Items_EN).replace('$_itemRemarks', resource.All_Tier[i].Remarks).replace('$_itemDate', resource.All_Tier[i].Redemption_Date).replace('$_itemPoints', Points).replace('$_itemQty', resource.All_Tier[i].QTY);[m
[32m+[m[32m                            tc_All_Tier += tc_imgText.replace('$_itemDir', itemDir).replace('$_itemImgSrc', imgArr[imgIndex]).replace('$_itemTitle', resource.All_Tier[i].Brand).replace('$_itemText', resource.All_Tier[i].Items_TC).replace('$_itemRemarks', resource.All_Tier[i].Remarks).replace('$_itemDate', resource.All_Tier[i].Redemption_Date).replace('$_itemPoints', Points).replace('$_itemQty', resource.All_Tier[i].QTY);[m
[32m+[m[32m                            sc_All_Tier += sc_imgText.replace('$_itemDir', itemDir).replace('$_itemImgSrc', imgArr[imgIndex]).replace('$_itemTitle', resource.All_Tier[i].Brand).replace('$_itemText', resource.All_Tier[i].Items_SC).replace('$_itemRemarks', resource.All_Tier[i].Remarks).replace('$_itemDate', resource.All_Tier[i].Redemption_Date).replace('$_itemPoints', Points).replace('$_itemQty', resource.All_Tier[i].QTY);[m
[32m+[m[32m                            imgIndex++;[m
[32m+[m[32m                        }[m
[32m+[m[32m                    }[m
[32m+[m
[32m+[m[32m                    // EDM拼接[m
[32m+[m[32m                    en_layout += en_style + en_header + en_Exclusive_Highlight + en_Event_Highlight + en_gift1 + en_Exclusive + en_gift2 + en_All_Tier + en_footer;[m
[32m+[m[32m                    tc_layout += tc_style + en_header + tc_Exclusive_Highlight + tc_Event_Highlight + tc_gift1 + tc_Exclusive + tc_gift2 + tc_All_Tier + tc_footer;[m
[32m+[m[32m                    sc_layout += sc_style + en_header + sc_Exclusive_Highlight + sc_Event_Highlight + sc_gift1 + sc_Exclusive + sc_gift2 + sc_All_Tier + sc_footer;[m
[32m+[m
[32m+[m[32m                    // EDM渲染[m
[32m+[m[32m                    $_edit_en.html(en_layout);[m
[32m+[m[32m                    $_edit_tc.html(tc_layout);[m
[32m+[m[32m                    $_edit_sc.html(sc_layout);[m
[32m+[m				[32m},[m
[32m+[m				[32merror: function(e) {[m
[32m+[m					[32mconsole.log(e);[m
[32m+[m					[32mreturn false[m
[32m+[m				[32m}[m
[32m+[m			[32m});[m
[32m+[m[32m        }[m
[32m+[m	[32m})[m
[32m+[m[32m})($)[m
\ No newline at end of file[m
[1mdiff --git a/dist/controller/edm/index.js b/dist/controller/edm/index.js[m
[1mnew file mode 100644[m
[1mindex 0000000..c099f7f[m
[1m--- /dev/null[m
[1m+++ b/dist/controller/edm/index.js[m
[36m@@ -0,0 +1,284 @@[m
[32m+[m[32m(function() {[m
[32m+[m	[32mlayui.use(['layer', 'element', 'form', 'colorpicker', 'copy'],[m
[32m+[m	[32mfunction() {[m
[32m+[m		[32mvar layer = layui.layer,[m
[32m+[m		[32melement = layui.element,[m
[32m+[m		[32mform = layui.form,[m
[32m+[m		[32mcopy = layui.copy,[m
[32m+[m		[32mcolorpicker = layui.colorpicker;[m
[32m+[m		[32mvar $this = '';[m
[32m+[m		[32mvar allImg = [];[m
[32m+[m		[32mvar default_bgcolor = '#ffffff';[m
[32m+[m		[32mvar lang_onoff = false;[m
[32m+[m		[32mvar footer_onoff = false;[m
[32m+[m		[32mvar online_onoff = false;[m
[32m+[m		[32mvar loadjs_onoff = false;[m
[32m+[m		[32mform.render();[m
[32m+[m		[32mcolorpicker.render({[m
[32m+[m			[32melem: '.table-bgcolor-colorpicker',[m
[32m+[m			[32mcolor: '#ffffff',[m
[32m+[m			[32mpredefine: true,[m
[32m+[m			[32mcolors: ['#F00', '#0F0', '#00F', 'rgb(255, 69, 0)', 'rgba(255, 69, 0, 0.5)'],[m
[32m+[m			[32mchange: function(color) {[m
[32m+[m				[32m$(this.elem).next('input').val(color || '#ffffff')[m
[32m+[m			[32m},[m
[32m+[m			[32mdone: function(color) {[m
[32m+[m				[32m$(this.elem).next('input').val(color || '#ffffff')[m
[32m+[m			[32m}[m
[32m+[m		[32m});[m
[32m+[m		[32mcolorpicker.render({[m
[32m+[m			[32melem: '.lang-color-colorpicker',[m
[32m+[m			[32mcolor: '#ffffff',[m
[32m+[m			[32mpredefine: true,[m
[32m+[m			[32mcolors: ['#F00', '#0F0', '#00F', 'rgb(255, 69, 0)', 'rgba(255, 69, 0, 0.5)'],[m
[32m+[m			[32mchange: function(color) {[m
[32m+[m				[32m$(this.elem).next('input').val(color || '#ffffff')[m
[32m+[m			[32m},[m
[32m+[m			[32mdone: function(color) {[m
[32m+[m				[32m$(this.elem).next('input').val(color || '#ffffff')[m
[32m+[m			[32m}[m
[32m+[m		[32m});[m
[32m+[m		[32mform.on('switch(lang)',[m
[32m+[m		[32mfunction(data) {[m
[32m+[m			[32mif (data.elem.checked) {[m
[32m+[m				[32mlang_onoff = true;[m
[32m+[m				[32m$('.lang-text').attr('disabled', false)[m
[32m+[m			[32m} else {[m
[32m+[m				[32mlang_onoff = false;[m
[32m+[m				[32m$('.lang-text').attr('disabled', true)[m
[32m+[m			[32m}[m
[32m+[m		[32m});[m
[32m+[m		[32mform.on('switch(look)',[m
[32m+[m		[32mfunction(data) {[m
[32m+[m			[32mif (data.elem.checked) {[m
[32m+[m				[32monline_onoff = true;[m
[32m+[m				[32m$('.edm-online-version').show()[m
[32m+[m			[32m} else {[m
[32m+[m				[32monline_onoff = false;[m
[32m+[m				[32m$('.edm-online-version').hide()[m
[32m+[m			[32m}[m
[32m+[m		[32m});[m
[32m+[m		[32mform.on('switch(footer)',[m
[32m+[m		[32mfunction(data) {[m
[32m+[m			[32mif (data.elem.checked) {[m
[32m+[m				[32mfooter_onoff = true;[m
[32m+[m				[32m$('.edm-footer').show()[m
[32m+[m			[32m} else {[m
[32m+[m				[32mfooter_onoff = false;[m
[32m+[m				[32m$('.edm-footer').hide()[m
[32m+[m			[32m}[m
[32m+[m		[32m});[m
[32m+[m		[32mform.on('switch(loadjs)',[m
[32m+[m		[32mfunction(data) {[m
[32m+[m			[32mif (data.elem.checked) {[m
[32m+[m				[32mloadjs_onoff = true;[m
[32m+[m				[32m$('.edm-loadjs').show()[m
[32m+[m			[32m} else {[m
[32m+[m				[32mloadjs_onoff = false;[m
[32m+[m				[32m$('.edm-loadjs').hide()[m
[32m+[m			[32m}[m
[32m+[m		[32m});[m
[32m+[m		[32mfunction getObjectURL(file) {[m
[32m+[m			[32mvar url = null;[m
[32m+[m			[32mif (window.createObjectURL != undefined) {[m
[32m+[m				[32murl = window.createObjectURL(file)[m
[32m+[m			[32m} else if (window.URL != undefined) {[m
[32m+[m				[32murl = window.URL.createObjectURL(file)[m
[32m+[m			[32m} else if (window.webkitURL != undefined) {[m
[32m+[m				[32murl = window.webkitURL.createObjectURL(file)[m
[32m+[m			[32m}[m
[32m+[m			[32mreturn url[m
[32m+[m		[32m};[m
[32m+[m		[32m$('.load-img-btn').click(function() {[m
[32m+[m			[32m$('#load-img').click()[m
[32m+[m		[32m});[m
[32m+[m		[32m$('input[type="file"]').change(function(e) {[m
[32m+[m			[32mvar edm_width = $('.flow-box').find('.edm-width').val();[m
[32m+[m			[32mvar img_natural_width = $('.flow-box').find('.img-natural-width').val();[m
[32m+[m			[32mvar all_img_href = $('.flow-box').find('.all-img-href').val();[m
[32m+[m			[32mvar files = document.getElementById('load-img').files;[m
[32m+[m			[32mallImg = [];[m
[32m+[m			[32mif (files.length) {[m
[32m+[m				[32m$('.load-img-box').html('');[m
[32m+[m				[32mfor (var i = 0; i < files.length; i++) {[m
[32m+[m					[32mvar img = document.createElement('img');[m
[32m+[m					[32mimg.src = getObjectURL(files[i]);[m
[32m+[m					[32m$('.load-img-box').append(img)[m
[32m+[m				[32m};[m
[32m+[m				[32msetTimeout(function() {[m
[32m+[m					[32m$('.load-img-box img').each(function(index, val) {[m
[32m+[m						[32mvar obj_img = {};[m
[32m+[m						[32mobj_img.name = files[index].name;[m
[32m+[m						[32mvar data = getImgNaturalDimensions(val);[m
[32m+[m						[32mobj_img.width = data.w;[m
[32m+[m						[32mobj_img.height = data.h;[m
[32m+[m						[32mobj_img.href = all_img_href;[m
[32m+[m						[32mobj_img.rowBgcolor = '#ffffff';[m
[32m+[m						[32mallImg.push(obj_img);[m
[32m+[m						[32m$(val).css({[m
[32m+[m							[32m'width': data.w * edm_width / img_natural_width / edm_width * 100 + '%'[m
[32m+[m						[32m})[m
[32m+[m					[32m})[m
[32m+[m				[32m},[m
[32m+[m				[32m500);[m
[32m+[m				[32m$('.output-edm').removeClass('layui-btn-disabled').attr('disabled', false)[m
[32m+[m			[32m}[m
[32m+[m		[32m});[m
[32m+[m		[32mfunction getImgNaturalDimensions(oImg) {[m
[32m+[m			[32mvar nWidth, nHeight;[m
[32m+[m			[32mif (oImg.naturalWidth) {[m
[32m+[m				[32mnWidth = oImg.naturalWidth;[m
[32m+[m				[32mnHeight = oImg.naturalHeight[m
[32m+[m			[32m} else {[m
[32m+[m				[32mvar nImg = new Image();[m
[32m+[m				[32mnImg.onload = function() {[m
[32m+[m					[32mnWidth = nImg.width,[m
[32m+[m					[32mnHeight = nImg.height[m
[32m+[m				[32m}[m
[32m+[m			[32m};[m
[32m+[m			[32mreturn {[m
[32m+[m				[32mw: nWidth,[m
[32m+[m				[32mh: nHeight[m
[32m+[m			[32m}[m
[32m+[m		[32m};[m
[32m+[m		[32m$('.flow-box .load-img-box').on('click', 'img',[m
[32m+[m		[32mfunction() {[m
[32m+[m			[32m$this = $(this);[m
[32m+[m			[32mlayer.open({[m
[32m+[m				[32mtype: 1,[m
[32m+[m				[32mcontent: '<div class="pop-ups"><div class="layui-row layui-col-space15"><div class="layui-col-md12"><label class="layui-form-label">行背景色</label><div class="layui-input-block"><div class="row-bgcolor-colorpicker" lay-tips="语言字体颜色"></div><input type="text" readonly="readonly" class="row-bgcolor layui-input colorpicker-val" value="#ffffff"/></div></div><div class="layui-col-md12"><label class="layui-form-label">图片链接</label><div class="layui-input-block"><input type="text" class="img-href layui-input"/></div></div></div></div>',[m
[32m+[m				[32msuccess: function(layero, index) {[m
[32m+[m					[32m$('.pop-ups .row-bgcolor').val(allImg[$this.index()].rowBgcolor);[m
[32m+[m					[32mcolorpicker.render({[m
[32m+[m						[32melem: '.row-bgcolor-colorpicker',[m
[32m+[m						[32mcolor: allImg[$this.index()].rowBgcolor || '#ffffff',[m
[32m+[m						[32mpredefine: true,[m
[32m+[m						[32mcolors: ['#F00', '#0F0', '#00F', 'rgb(255, 69, 0)', 'rgba(255, 69, 0, 0.5)'],[m
[32m+[m						[32mchange: function(color) {[m
[32m+[m							[32m$(this.elem).next('input').val(color || '#ffffff')[m
[32m+[m						[32m},[m
[32m+[m						[32mdone: function(color) {[m
[32m+[m							[32m$(this.elem).next('input').val(color || '#ffffff')[m
[32m+[m						[32m}[m
[32m+[m					[32m});[m
[32m+[m					[32m$('.pop-ups .img-href').val(allImg[$this.index()].href)[m
[32m+[m				[32m},[m
[32m+[m				[32mbtn: ['取消', '确定'],[m
[32m+[m				[32myes: function(index, layero) {[m
[32m+[m					[32mlayer.close(index)[m
[32m+[m				[32m},[m
[32m+[m				[32mbtn2: function(index, layero) {[m
[32m+[m					[32mallImg[$this.index()].href = $('.pop-ups .img-href').val().trim();[m
[32m+[m					[32mallImg[$this.index()].rowBgcolor = $('.pop-ups .row-bgcolor').val().trim()[m
[32m+[m				[32m}[m
[32m+[m			[32m})[m
[32m+[m		[32m});[m
[32m+[m		[32m$('.flow-box .output-edm').click(function() {[m
[32m+[m			[32m$this = $(this);[m
[32m+[m			[32mvar edm_html = '';[m
[32m+[m			[32mvar temporary_width = 0;[m
[32m+[m			[32mvar $this_parents = $(this).parents('.flow-box');[m
[32m+[m			[32mvar edm_width = $this_parents.find('.edm-width').val();[m
[32m+[m			[32mvar table_bgcolor = $this_parents.find('.table-bgcolor').val() ? $this_parents.find('.table-bgcolor').val() : default_bgcolor;[m
[32m+[m			[32mvar img_natural_width = $this_parents.find('.img-natural-width').val();[m
[32m+[m			[32mvar lang_color = $this_parents.find('.lang-color').val();[m
[32m+[m			[32mvar lang_text = $this_parents.find('.lang-text').val();[m
[32m+[m			[32mvar all_img_src = $this_parents.find('.all-img-src').val();[m
[32m+[m			[32mvar all_img_href = $this_parents.find('.all-img-href').val();[m
[32m+[m			[32mvar preheader_text = $this_parents.find('.preheader-text').val();[m
[32m+[m			[32mvar href_type = $this_parents.find('.href-type option:selected').text();[m
[32m+[m			[32mvar edm_footer = $this_parents.find('.edm-footer textarea').val();[m
[32m+[m			[32mvar edm_online_version = $this_parents.find('.edm-online-version textarea').val();[m
[32m+[m			[32mvar edm_js = $this_parents.find('.edm-loadjs textarea').val();[m
[32m+[m			[32mvar edm_style = '';[m
[32m+[m			[32m$.ajax({[m
[32m+[m				[32mtype: "get",[m
[32m+[m				[32murl: "./dist/controller/edm/edm-style.css",[m
[32m+[m				[32masync: false,[m
[32m+[m				[32mdataType: 'html',[m
[32m+[m				[32msuccess: function(e) {[m
[32m+[m					[32medm_style = e[m
[32m+[m				[32m},[m
[32m+[m				[32merror: function(e) {[m
[32m+[m					[32mconsole.log(e);[m
[32m+[m					[32mreturn false[m
[32m+[m				[32m}[m
[32m+[m			[32m});[m
[32m+[m			[32medm_html += '<meta charset="UTF-8"/><div><style>' + edm_style + '</style></div>';[m
[32m+[m			[32mif (loadjs_onoff) {[m
[32m+[m				[32medm_html += '<div><script type="text/javascript">' + edm_js + '</script></div>'[m
[32m+[m			[32m}[m
[32m+[m			[32medm_html += '<table class="main" style="border-collapse: collapse !important; border-spacing: 0px !important; table-layout: fixed !important; margin: 0px auto !important; width: 100%;" border="0" cellspacing="0" cellpadding="0" bgcolor="#ffffff" align="center"><tbody><tr style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;"><td align="center" valign="top" style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; mso-table-lspace: 0pt !important; mso-table-rspace: 0pt !important;">';[m
[32m+[m			[32medm_html += '<!-- Visually Hidden Preheader Text : BEGIN --><div style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; display: none; font-size: 1px; line-height: 1px; max-height: 0px; max-width: 0px; opacity: 0; overflow: hidden; mso-hide: all; font-family: sans-serif;">' + preheader_text + '</div><!-- Visually Hidden Preheader Text : END -->';[m
[32m+[m			[32medm_html += '<div style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; max-width: ' + edm_width + 'px;"><!--[if (gte mso 9)|(IE)]> <table cellspacing="0" cellpadding="0" border="0" width="' + edm_width + '" align="center" style="-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;mso-table-lspace:0pt !important;mso-table-rspace:0pt !important;border-spacing:0 !important;border-collapse:collapse !important;table-layout:fixed !important;margin:0 auto !important;" mce_style="-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;mso-table-lspace:0pt !important;mso-table-rspace:0pt !important;border-spacing:0 !important;border-collapse:collapse !important;table-layout:fixed !important;margin:0 auto !important;" ><tr style="-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;" mce_style="-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;" ><td style="-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;mso-table-lspace:0pt !important;mso-table-rspace:0pt !important;" mce_style="-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;mso-table-lspace:0pt !important;mso-table-rspace:0pt !important;" ><![endif]--><!-- Email Body : BEGIN --><table style="max-width: ' + edm_width + 'px; border-spacing: 0px !important; border-collapse: collapse !important; margin: 0px auto !important; table-layout: fixed !important; width: 100%; background: ' + table_bgcolor + ';" border="0" cellspacing="0" cellpadding="0" align="center" bgcolor="' + table_bgcolor + '"><tbody>';[m
[32m+[m			[32mif (online_onoff) {[m
[32m+[m				[32medm_html += '<tr style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;"><td style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; mso-table-lspace: 0pt !important; mso-table-rspace: 0pt !important;"><table style="border-spacing: 0px !important; border-collapse: collapse !important; margin: 0px auto !important; table-layout: fixed !important; width: 100%; background: #ffffff;" border="0" bgcolor="#ffffff" cellspacing="0" cellpadding="0"><tbody><tr style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;"><td class="banner" style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; mso-table-lspace: 0pt !important; mso-table-rspace: 0pt !important; padding: 15px 10px; text-align: center;">' + edm_online_version + '</td></tr></tbody></table></td></tr>'[m
[32m+[m			[32m}[m
[32m+[m			[32mif (lang_onoff) {[m
[32m+[m				[32medm_html += '<tr style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;"><td style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; mso-table-lspace: 0pt !important; mso-table-rspace: 0pt !important;"><table style="border-spacing: 0px !important; border-collapse: collapse !important; margin: 0px auto !important; table-layout: fixed !important; width: 100%;" border="0" cellspacing="0" cellpadding="0"><tbody><tr style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;"><td style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; mso-height-rule: exactly; mso-table-lspace: 0pt !important; mso-table-rspace: 0pt !important; font-family: Microsoft JhengHei, Microsoft YaHei, Arial; font-size: 12px; line-height: 18px; color: #000000; text-align: right; padding: 15px; width: 30px;"><!-- *|XG:' + href_type + '|* // --><span style="color: ' + lang_color + '!important; text-decoration: none!important">' + lang_text + '</span><!-- *|END:XG:' + href_type + '|* // --></td></tr></tbody></table></td></tr>'[m
[32m+[m			[32m};[m
[32m+[m			[32mfor (var i = 0; i < allImg.length; i++) {[m
[32m+[m				[32mvar w = allImg[i].width * edm_width / img_natural_width;[m
[32m+[m				[32mvar h = allImg[i].height;[m
[32m+[m				[32mvar href = allImg[i].href;[m
[32m+[m				[32mvar name = allImg[i].name;[m
[32m+[m				[32mif (w == edm_width) {[m
[32m+[m					[32medm_html += '<tr style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;"><td style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; mso-table-lspace: 0pt !important; mso-table-rspace: 0pt !important;"><table style="border-spacing: 0px !important; border-collapse: collapse !important; margin: 0px auto !important; table-layout: fixed !important; width: 100%; background: ' + allImg[i].rowBgcolor + ';" bgcolor="' + allImg[i].rowBgcolor + '" border="0" cellspacing="0" cellpadding="0"><tbody><tr style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;">';[m
[32m+[m					[32mif (allImg[i].href) {[m
[32m+[m						[32medm_html += '<td class="banner" style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; mso-table-lspace: 0pt !important; mso-table-rspace: 0pt !important; padding: 0px; text-align: center;width: ' + w / edm_width * 100 + '%;"><a style="line-height: 0;" href="' + allImg[i].href + '" target="_blank"><img style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; width: 100%; max-width: ' + w + 'px; -ms-interpolation-mode: bicubic; display: block; border: 0; margin: 0;line-height: 0;" src="' + all_img_src + allImg[i].name + '" alt="" width="' + w + '" align="middle" border="0" /></a></td>'[m
[32m+[m					[32m} else if (all_img_href) {[m
[32m+[m						[32medm_html += '<td class="banner" style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; mso-table-lspace: 0pt !important; mso-table-rspace: 0pt !important; padding: 0px; text-align: center;width: ' + w / edm_width * 100 + '%;"><a style="line-height: 0;" href="' + all_img_href + '" target="_blank"><img style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; width: 100%; max-width: ' + w + 'px; -ms-interpolation-mode: bicubic; display: block; border: 0; margin: 0;line-height: 0;" src="' + all_img_src + allImg[i].name + '" alt="" width="' + w + '" align="middle" border="0" /></a></td>'[m
[32m+[m					[32m} else {[m
[32m+[m						[32medm_html += '<td class="banner" style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; mso-table-lspace: 0pt !important; mso-table-rspace: 0pt !important; padding: 0px; text-align: center;width: ' + w / edm_width * 100 + '%;"><img style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; width: 100%; max-width: ' + w + 'px; -ms-interpolation-mode: bicubic; display: block; border: 0; margin: 0;line-height: 0;" src="' + all_img_src + allImg[i].name + '" alt="" width="' + w + '" align="middle" border="0" /></td>'[m
[32m+[m					[32m}[m
[32m+[m					[32medm_html += '</tr></tbody></table></td></tr>';[m
[32m+[m					[32mtemporary_width = 0[m
[32m+[m				[32m} else {[m
[32m+[m					[32mif (!temporary_width) {[m
[32m+[m						[32medm_html += '<tr style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;"><td style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; mso-table-lspace: 0pt !important; mso-table-rspace: 0pt !important;"><table style="border-spacing: 0px !important; border-collapse: collapse !important; margin: 0px auto !important; table-layout: fixed !important; width: 100%; background: ' + allImg[i].rowBgcolor + ';" bgcolor="' + allImg[i].rowBgcolor + '" border="0" cellspacing="0" cellpadding="0"><tbody><tr style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;">'[m
[32m+[m					[32m}[m
[32m+[m					[32mif (temporary_width < edm_width) {[m
[32m+[m						[32mtemporary_width += w;[m
[32m+[m						[32mif (allImg[i].href) {[m
[32m+[m							[32medm_html += '<td class="banner" style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; mso-table-lspace: 0pt !important; mso-table-rspace: 0pt !important; padding: 0px; text-align: center;width: ' + w / edm_width * 100 + '%;"><a style="line-height: 0;" href="' + allImg[i].href + '" target="_blank"><img style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; width: 100%; max-width: ' + w + 'px; -ms-interpolation-mode: bicubic; display: block; border: 0; margin: 0;line-height: 0;" src="' + all_img_src + allImg[i].name + '" alt="" width="' + w + '" align="middle" border="0" /></a></td>'[m
[32m+[m						[32m} else if (all_img_href) {[m
[32m+[m							[32medm_html += '<td class="banner" style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; mso-table-lspace: 0pt !important; mso-table-rspace: 0pt !important; padding: 0px; text-align: center;width: ' + w / edm_width * 100 + '%;"><a style="line-height: 0;" href="' + all_img_href + '" target="_blank"><img style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; width: 100%; max-width: ' + w + 'px; -ms-interpolation-mode: bicubic; display: block; border: 0; margin: 0;line-height: 0;" src="' + all_img_src + allImg[i].name + '" alt="" width="' + w + '" align="middle" border="0" /></a></td>'[m
[32m+[m						[32m} else {[m
[32m+[m							[32medm_html += '<td class="banner" style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; mso-table-lspace: 0pt !important; mso-table-rspace: 0pt !important; padding: 0px; text-align: center;width: ' + w / edm_width * 100 + '%;"><img style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; width: 100%; max-width: ' + w + 'px; -ms-interpolation-mode: bicubic; display: block; border: 0; margin: 0;line-height: 0;" src="' + all_img_src + allImg[i].name + '" alt="" width="' + w + '" align="middle" border="0" /></td>'[m
[32m+[m						[32m}[m
[32m+[m						[32mif (temporary_width >= edm_width) {[m
[32m+[m							[32mtemporary_width = 0[m
[32m+[m						[32m}[m
[32m+[m					[32m}[m
[32m+[m					[32mif (!temporary_width) {[m
[32m+[m						[32medm_html += '</tr></tbody></table></td></tr>'[m
[32m+[m					[32m}[m
[32m+[m				[32m}[m
[32m+[m			[32m};[m
[32m+[m			[32mif (footer_onoff) {[m
[32m+[m				[32medm_html += '<tr style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;"><td style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; mso-table-lspace: 0pt !important; mso-table-rspace: 0pt !important;"><table style="border-spacing: 0px !important; border-collapse: collapse !important; margin: 0px auto !important; table-layout: fixed !important; width: 100%; background: #ffffff;" border="0" bgcolor="#ffffff" cellspacing="0" cellpadding="0"><tbody><tr style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;"><td class="banner" style="-ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; mso-table-lspace: 0pt !important; mso-table-rspace: 0pt !important; padding: 15px 10px; text-align: center; font-size: 12px;">' + edm_footer + '</td></tr></tbody></table></td></tr>'[m
[32m+[m			[32m};[m
[32m+[m			[32medm_html += '</tbody></table><!-- Email Body : END --><!--[if (gte mso 9)|(IE)]></td></tr></table><![endif]--></div></td></tr></tbody></table>';[m
[32m+[m			[32m$('.look').html(edm_html);[m
[32m+[m			[32mlayer.open({[m
[32m+[m				[32mtype: 1,[m
[32m+[m				[32mtitle: '提示',[m
[32m+[m				[32marea: 'auto',[m
[32m+[m				[32mmaxWidth: 360,[m
[32m+[m				[32mcontent: '<div style="padding: 20px 15px;text-align: center;">代码成功生成，是否前往查看?</div>',[m
[32m+[m				[32mbtn: ['等等', '确定'],[m
[32m+[m				[32myes: function(index, layero) {[m
[32m+[m					[32mlayer.close(index)[m
[32m+[m				[32m},[m
[32m+[m				[32mbtn2: function(index, layero) {[m
[32m+[m					[32melement.tabChange('tabChange', '02')[m
[32m+[m				[32m}[m
[32m+[m			[32m});[m
[32m+[m			[32m$('.copy-code').removeClass('layui-btn-disabled').attr('disabled', false)[m
[32m+[m		[32m});[m
[32m+[m		[32m$('.copy-code').click(function() {[m
[32m+[m			[32mvar code = $('.look').html();[m
[32m+[m			[32mcopy.copyFn(code)[m
[32m+[m		[32m})[m
[32m+[m	[32m})[m
[32m+[m[32m})($)[m
\ No newline at end of file[m
[1mdiff --git a/dist/controller/edm/xlsx.core.min.js b/dist/controller/edm/xlsx.core.min.js[m
[1mnew file mode 100644[m
[1mindex 0000000..5fe3ba9[m
[1m--- /dev/null[m
[1m+++ b/dist/controller/edm/xlsx.core.min.js[m
[36m@@ -0,0 +1,15 @@[m
[32m+[m[32m/* xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */[m
[32m+[m[32mvar DO_NOT_EXPORT_CODEPAGE=true;var DO_NOT_EXPORT_JSZIP=true;(function(e){if("object"==typeof exports&&"undefined"!=typeof module&&"undefined"==typeof DO_NOT_EXPORT_JSZIP)module.exports=e();else if("function"==typeof define&&define.amd){JSZip=e();define([],e)}else{var r;"undefined"!=typeof window?r=window:"undefined"!=typeof global?r=global:"undefined"!=typeof $&&$.global?r=$.global:"undefined"!=typeof self&&(r=self),r.JSZip=e()}})(function(){var e,r,t;return function a(e,r,t){function n(s,o){if(!r[s]){if(!e[s]){var l=typeof require=="function"&&require;if(!o&&l)return l(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+s+"'")}var f=r[s]={exports:{}};e[s][0].call(f.exports,function(r){var t=e[s][1][r];return n(t?t:r)},f,f.exports,a,e,r,t)}return r[s].exports}var i=typeof require=="function"&&require;for(var s=0;s<t.length;s++)n(t[s]);return n}({1:[function(e,r,t){"use strict";var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.encode=function(e,r){var t="";var n,i,s,o,l,f,c;var u=0;while(u<e.length){n=e.charCodeAt(u++);i=e.charCodeAt(u++);s=e.charCodeAt(u++);o=n>>2;l=(n&3)<<4|i>>4;f=(i&15)<<2|s>>6;c=s&63;if(isNaN(i)){f=c=64}else if(isNaN(s)){c=64}t=t+a.charAt(o)+a.charAt(l)+a.charAt(f)+a.charAt(c)}return t};t.decode=function(e,r){var t="";var n,i,s;var o,l,f,c;var u=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(u<e.length){o=a.indexOf(e.charAt(u++));l=a.indexOf(e.charAt(u++));f=a.indexOf(e.charAt(u++));c=a.indexOf(e.charAt(u++));n=o<<2|l>>4;i=(l&15)<<4|f>>2;s=(f&3)<<6|c;t=t+String.fromCharCode(n);if(f!=64){t=t+String.fromCharCode(i)}if(c!=64){t=t+String.fromCharCode(s)}}return t}},{}],2:[function(e,r,t){"use strict";function a(){this.compressedSize=0;this.uncompressedSize=0;this.crc32=0;this.compressionMethod=null;this.compressedContent=null}a.prototype={getContent:function(){return null},getCompressedContent:function(){return null}};r.exports=a},{}],3:[function(e,r,t){"use strict";t.STORE={magic:"\0\0",compress:function(e){return e},uncompress:function(e){return e},compressInputType:null,uncompressInputType:null};t.DEFLATE=e("./flate")},{"./flate":8}],4:[function(e,r,t){"use strict";var a=e("./utils");var n=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];r.exports=function i(e,r){if(typeof e==="undefined"||!e.length){return 0}var t=a.getTypeOf(e)!=="string";if(typeof r=="undefined"){r=0}var i=0;var s=0;var o=0;r=r^-1;for(var l=0,f=e.length;l<f;l++){o=t?e[l]:e.charCodeAt(l);s=(r^o)&255;i=n[s];r=r>>>8^i}return r^-1}},{"./utils":21}],5:[function(e,r,t){"use strict";var a=e("./utils");function n(e){this.data=null;this.length=0;this.index=0}n.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<e||e<0){throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")}},setIndex:function(e){this.checkIndex(e);this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(e){},readInt:function(e){var r=0,t;this.checkOffset(e);for(t=this.index+e-1;t>=this.index;t--){r=(r<<8)+this.byteAt(t)}this.index+=e;return r},readString:function(e){return a.transformTo("string",this.readData(e))},readData:function(e){},lastIndexOfSignature:function(e){},readDate:function(){var e=this.readInt(4);return new Date((e>>25&127)+1980,(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(e&31)<<1)}};r.exports=n},{"./utils":21}],6:[function(e,r,t){"use strict";t.base64=false;t.binary=false;t.dir=false;t.createFolders=false;t.date=null;t.compression=null;t.comment=null},{}],7:[function(e,r,t){"use strict";var a=e("./utils");t.string2binary=function(e){return a.string2binary(e)};t.string2Uint8Array=function(e){return a.transformTo("uint8array",e)};t.uint8Array2String=function(e){return a.transformTo("string",e)};t.string2Blob=function(e){var r=a.transformTo("arraybuffer",e);return a.arrayBuffer2Blob(r)};t.arrayBuffer2Blob=function(e){return a.arrayBuffer2Blob(e)};t.transformTo=function(e,r){return a.transformTo(e,r)};t.getTypeOf=function(e){return a.getTypeOf(e)};t.checkSupport=function(e){return a.checkSupport(e)};t.MAX_VALUE_16BITS=a.MAX_VALUE_16BITS;t.MAX_VALUE_32BITS=a.MAX_VALUE_32BITS;t.pretty=function(e){return a.pretty(e)};t.findCompression=function(e){return a.findCompression(e)};t.isRegExp=function(e){return a.isRegExp(e)}},{"./utils":21}],8:[function(e,r,t){"use strict";var a=typeof Uint8Array!=="undefined"&&typeof Uint16Array!=="undefined"&&typeof Uint32Array!=="undefined";var n=e("pako");t.uncompressInputType=a?"uint8array":"array";t.compressInputType=a?"uint8array":"array";t.magic="\b\0";t.compress=function(e){return n.deflateRaw(e)};t.uncompress=function(e){return n.inflateRaw(e)}},{pako:24}],9:[function(e,r,t){"use strict";var a=e("./base64");function n(e,r){if(!(this instanceof n))return new n(e,r);this.files={};this.comment=null;this.root="";if(e){this.load(e,r)}this.clone=function(){var e=new n;for(var r in this){if(typeof this[r]!=="function"){e[r]=this[r]}}return e}}n.prototype=e("./object");n.prototype.load=e("./load");n.support=e("./support");n.defaults=e("./defaults");n.utils=e("./deprecatedPublicUtils");n.base64={encode:function(e){return a.encode(e)},decode:function(e){return a.decode(e)}};n.compressions=e("./compressions");r.exports=n},{"./base64":1,"./compressions":3,"./defaults":6,"./deprecatedPublicUtils":7,"./load":10,"./object":13,"./support":17}],10:[function(e,r,t){"use strict";var a=e("./base64");var n=e("./zipEntries");r.exports=function(e,r){var t,i,s,o;r=r||{};if(r.base64){e=a.decode(e)}i=new n(e,r);t=i.files;for(s=0;s<t.length;s++){o=t[s];this.file(o.fileName,o.decompressed,{binary:true,optimizedBinaryString:true,date:o.date,dir:o.dir,comment:o.fileComment.length?o.fileComment:null,createFolders:r.createFolders})}if(i.zipComment.length){this.comment=i.zipComment}return this}},{"./base64":1,"./zipEntries":22}],11:[function(e,r,t){(function(e){"use strict";r.exports=function(r,t){return new e(r,t)};r.exports.test=function(r){return e.isBuffer(r)}}).call(this,typeof Buffer!=="undefined"?Buffer:undefined)},{}],12:[function(e,r,t){"use strict";var a=e("./uint8ArrayReader");function n(e){this.data=e;this.length=this.data.length;this.index=0}n.prototype=new a;n.prototype.readData=function(e){this.checkOffset(e);var r=this.data.slice(this.index,this.index+e);this.index+=e;return r};r.exports=n},{"./uint8ArrayReader":18}],13:[function(e,r,t){"use strict";var a=e("./support");var n=e("./utils");var i=e("./crc32");var s=e("./signature");var o=e("./defaults");var l=e("./base64");var f=e("./compressions");var c=e("./compressedObject");var u=e("./nodeBuffer");var h=e("./utf8");var d=e("./stringWriter");var v=e("./uint8ArrayWriter");var p=function(e){if(e._data instanceof c){e._data=e._data.getContent();e.options.binary=true;e.options.base64=false;if(n.getTypeOf(e._data)==="uint8array"){var r=e._data;e._data=new Uint8Array(r.length);if(r.length!==0){e._data.set(r,0)}}}return e._data};var b=function(e){var r=p(e),t=n.getTypeOf(r);if(t==="string"){if(!e.options.binary){if(a.nodebuffer){return u(r,"utf-8")}}return e.asBinary()}return r};var m=function(e){var r=p(this);if(r===null||typeof r==="undefined"){return""}if(this.options.base64){r=l.decode(r)}if(e&&this.options.binary){r=x.utf8decode(r)}else{r=n.transformTo("string",r)}if(!e&&!this.options.binary){r=n.transformTo("string",x.utf8encode(r))}return r};var g=function(e,r,t){this.name=e;this.dir=t.dir;this.date=t.date;this.comment=t.comment;this._data=r;this.options=t;this._initialMetadata={dir:t.dir,date:t.date}};g.prototype={asText:function(){return m.call(this,true)},asBinary:function(){return m.call(this,false)},asNodeBuffer:function(){var e=b(this);return n.transformTo("nodebuffer",e)},asUint8Array:function(){var e=b(this);return n.transformTo("uint8array",e)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var E=function(e,r){var t="",a;for(a=0;a<r;a++){t+=String.fromCharCode(e&255);e=e>>>8}return t};var k=function(){var e={},r,t;for(r=0;r<arguments.length;r++){for(t in arguments[r]){if(arguments[r].hasOwnProperty(t)&&typeof e[t]==="undefined"){e[t]=arguments[r][t]}}}return e};var S=function(e){e=e||{};if(e.base64===true&&(e.binary===null||e.binary===undefined)){e.binary=true}e=k(e,o);e.date=e.date||new Date;if(e.compression!==null)e.compression=e.compression.toUpperCase();return e};var w=function(e,r,t){var a=n.getTypeOf(r),i;t=S(t);if(t.createFolders&&(i=B(e))){C.call(this,i,true)}if(t.dir||r===null||typeof r==="undefined"){t.base64=false;t.binary=false;r=null}else if(a==="string"){if(t.binary&&!t.base64){if(t.optimizedBinaryString!==true){r=n.string2binary(r)}}}else{t.base64=false;t.binary=true;if(!a&&!(r instanceof c)){throw new Error("The data of '"+e+"' is in an unsupported format !")}if(a==="arraybuffer"){r=n.transformTo("uint8array",r)}}var s=new g(e,r,t);this.files[e]=s;return s};var B=function(e){if(e.slice(-1)=="/"){e=e.substring(0,e.length-1)}var r=e.lastIndexOf("/");return r>0?e.substring(0,r):""};var C=function(e,r){if(e.slice(-1)!="/"){e+="/"}r=typeof r!=="undefined"?r:false;if(!this.files[e]){w.call(this,e,null,{dir:true,createFolders:r})}return this.files[e]};var _=function(e,r){var t=new c,a;if(e._data instanceof c){t.uncompressedSize=e._data.uncompressedSize;t.crc32=e._data.crc32;if(t.uncompressedSize===0||e.dir){r=f["STORE"];t.compressedContent="";t.crc32=0}else if(e._data.compressionMethod===r.magic){t.compressedContent=e._data.getCompressedContent()}else{a=e._data.getContent();t.compressedContent=r.compress(n.transformTo(r.compressInputType,a))}}else{a=b(e);if(!a||a.length===0||e.dir){r=f["STORE"];a=""}t.uncompressedSize=a.length;t.crc32=i(a);t.compressedContent=r.compress(n.transformTo(r.compressInputType,a))}t.compressedSize=t.compressedContent.length;t.compressionMethod=r.magic;return t};var T=function(e,r,t,a){var o=t.compressedContent,l=n.transformTo("string",h.utf8encode(r.name)),f=r.comment||"",c=n.transformTo("string",h.utf8encode(f)),u=l.length!==r.name.length,d=c.length!==f.length,v=r.options,p,b,m="",g="",k="",S,w;if(r._initialMetadata.dir!==r.dir){S=r.dir}else{S=v.dir}if(r._initialMetadata.date!==r.date){w=r.date}else{w=v.date}p=w.getHours();p=p<<6;p=p|w.getMinutes();p=p<<5;p=p|w.getSeconds()/2;b=w.getFullYear()-1980;b=b<<4;b=b|w.getMonth()+1;b=b<<5;b=b|w.getDate();if(u){g=E(1,1)+E(i(l),4)+l;m+="up"+E(g.length,2)+g}if(d){k=E(1,1)+E(this.crc32(c),4)+c;m+="uc"+E(k.length,2)+k}var B="";B+="\n\0";B+=u||d?"\0\b":"\0\0";B+=t.compressionMethod;B+=E(p,2);B+=E(b,2);B+=E(t.crc32,4);B+=E(t.compressedSize,4);B+=E(t.uncompressedSize,4);B+=E(l.length,2);B+=E(m.length,2);var C=s.LOCAL_FILE_HEADER+B+l+m;var _=s.CENTRAL_FILE_HEADER+"\0"+B+E(c.length,2)+"\0\0"+"\0\0"+(S===true?"\0\0\0":"\0\0\0\0")+E(a,4)+l+m+c;return{fileRecord:C,dirRecord:_,compressedObject:t}};var x={load:function(e,r){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(e){var r=[],t,a,n,i;for(t in this.files){if(!this.files.hasOwnProperty(t)){continue}n=this.files[t];i=new g(n.name,n._data,k(n.options));a=t.slice(this.root.length,t.length);if(t.slice(0,this.root.length)===this.root&&e(a,i)){r.push(i)}}return r},file:function(e,r,t){if(arguments.length===1){if(n.isRegExp(e)){var a=e;return this.filter(function(e,r){return!r.dir&&a.test(e)})}else{return this.filter(function(r,t){return!t.dir&&r===e})[0]||null}}else{e=this.root+e;w.call(this,e,r,t)}return this},folder:function(e){if(!e){return this}if(n.isRegExp(e)){return this.filter(function(r,t){return t.dir&&e.test(r)})}var r=this.root+e;var t=C.call(this,r);var a=this.clone();a.root=t.name;return a},remove:function(e){e=this.root+e;var r=this.files[e];if(!r){if(e.slice(-1)!="/"){e+="/"}r=this.files[e]}if(r&&!r.dir){delete this.files[e]}else{var t=this.filter(function(r,t){return t.name.slice(0,e.length)===e});for(var a=0;a<t.length;a++){delete this.files[t[a].name]}}return this},generate:function(e){e=k(e||{},{base64:true,compression:"STORE",type:"base64",comment:null});n.checkSupport(e.type);var r=[],t=0,a=0,i,o,c=n.transformTo("string",this.utf8encode(e.comment||this.comment||""));for(var u in this.files){if(!this.files.hasOwnProperty(u)){continue}var h=this.files[u];var p=h.options.compression||e.compression.toUpperCase();var b=f[p];if(!b){throw new Error(p+" is not a valid compression method !")}var m=_.call(this,h,b);var g=T.call(this,u,h,m,t);t+=g.fileRecord.length+m.compressedSize;a+=g.dirRecord.length;r.push(g)}var S="";S=s.CENTRAL_DIRECTORY_END+"\0\0"+"\0\0"+E(r.length,2)+E(r.length,2)+E(a,4)+E(t,4)+E(c.length,2)+c;var w=e.type.toLowerCase();if(w==="uint8array"||w==="arraybuffer"||w==="blob"||w==="nodebuffer"){i=new v(t+a+S.length)}else{i=new d(t+a+S.length)}for(o=0;o<r.length;o++){i.append(r[o].fileRecord);i.append(r[o].compressedObject.compressedContent)}for(o=0;o<r.length;o++){i.append(r[o].dirRecord)}i.append(S);var B=i.finalize();switch(e.type.toLowerCase()){case"uint8array":;case"arraybuffer":;case"nodebuffer":return n.transformTo(e.type.toLowerCase(),B);case"blob":return n.arrayBuffer2Blob(n.transformTo("arraybuffer",B));case"base64":return e.base64?l.encode(B):B;default:return B;}},crc32:function(e,r){return i(e,r)},utf8encode:function(e){return n.transformTo("string",h.utf8encode(e))},utf8decode:function(e){return h.utf8decode(e)}};r.exports=x},{"./base64":1,"./compressedObject":2,"./compressions":3,"./crc32":4,"./defaults":6,"./nodeBuffer":11,"./signature":14,"./stringWriter":16,"./support":17,"./uint8ArrayWriter":19,"./utf8":20,"./utils":21}],14:[function(e,r,t){"use strict";t.LOCAL_FILE_HEADER="PK";t.CENTRAL_FILE_HEADER="PK";t.CENTRAL_DIRECTORY_END="PK";t.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK";t.ZIP64_CENTRAL_DIRECTORY_END="PK";t.DATA_DESCRIPTOR="PK\b"},{}],15:[function(e,r,t){"use strict";var a=e("./dataReader");var n=e("./utils");function i(e,r){this.data=e;if(!r){this.data=n.string2binary(this.data)}this.length=this.data.length;this.index=0}i.prototype=new a;i.prototype.byteAt=function(e){return this.data.charCodeAt(e)};i.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)};i.prototype.readData=function(e){this.checkOffset(e);var r=this.data.slice(this.index,this.index+e);this.index+=e;return r};r.exports=i},{"./dataReader":5,"./utils":21}],16:[function(e,r,t){"use strict";var a=e("./utils");var n=function(){this.data=[]};n.prototype={append:function(e){e=a.transformTo("string",e);this.data.push(e)},finalize:function(){return this.data.join("")}};r.exports=n},{"./utils":21}],17:[function(e,r,t){(function(e){"use strict";t.base64=true;t.array=true;t.string=true;t.arraybuffer=typeof ArrayBuffer!=="undefined"&&typeof Uint8Array!=="undefined";t.nodebuffer=typeof e!=="undefined";t.uint8array=typeof Uint8Array!=="undefined";if(typeof ArrayBuffer==="undefined"){t.blob=false}else{var r=new ArrayBuffer(0);try{t.blob=new Blob([r],{type:"application/zip"}).size===0}catch(a){try{var n=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;var i=new n;i.append(r);t.blob=i.getBlob("application/zip").size===0}catch(a){t.blob=false}}}}).call(this,typeof Buffer!=="undefined"?Buffer:undefined)},{}],18:[function(e,r,t){"use strict";var a=e("./dataReader");function n(e){if(e){this.data=e;this.length=this.data.length;this.index=0}}n.prototype=new a;n.prototype.byteAt=function(e){return this.data[e]};n.prototype.lastIndexOfSignature=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1),a=e.charCodeAt(2),n=e.charCodeAt(3);for(var i=this.length-4;i>=0;--i){if(this.data[i]===r&&this.data[i+1]===t&&this.data[i+2]===a&&this.data[i+3]===n){return i}}return-1};n.prototype.readData=function(e){this.checkOffset(e);if(e===0){return new Uint8Array(0)}var r=this.data.subarray(this.index,this.index+e);this.index+=e;return r};r.exports=n},{"./dataReader":5}],19:[function(e,r,t){"use strict";var a=e("./utils");var n=function(e){this.data=new Uint8Array(e);this.index=0};n.prototype={append:function(e){if(e.length!==0){e=a.transformTo("uint8array",e);this.data.set(e,this.index);this.index+=e.length}},finalize:function(){return this.data}};r.exports=n},{"./utils":21}],20:[function(e,r,t){"use strict";var a=e("./utils");var n=e("./support");var i=e("./nodeBuffer");var s=new Array(256);for(var o=0;o<256;o++){s[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1}s[254]=s[254]=1;var l=function(e){var r,t,a,i,s,o=e.length,l=0;for(i=0;i<o;i++){t=e.charCodeAt(i);if((t&64512)===55296&&i+1<o){a=e.charCodeAt(i+1);if((a&64512)===56320){t=65536+(t-55296<<10)+(a-56320);i++}}l+=t<128?1:t<2048?2:t<65536?3:4}if(n.uint8array){r=new Uint8Array(l)}else{r=new Array(l)}for(s=0,i=0;s<l;i++){t=e.charCodeAt(i);if((t&64512)===55296&&i+1<o){a=e.charCodeAt(i+1);if((a&64512)===56320){t=65536+(t-55296<<10)+(a-56320);i++}}if(t<128){r[s++]=t}else if(t<2048){r[s++]=192|t>>>6;r[s++]=128|t&63}else if(t<65536){r[s++]=224|t>>>12;r[s++]=128|t>>>6&63;r[s++]=128|t&63}else{r[s++]=240|t>>>18;r[s++]=128|t>>>12&63;r[s++]=128|t>>>6&63;r[s++]=128|t&63}}return r};var f=function(e,r){var t;r=r||e.length;if(r>e.length){r=e.length}t=r-1;while(t>=0&&(e[t]&192)===128){t--}if(t<0){return r}if(t===0){return r}return t+s[e[t]]>r?t:r};var c=function(e){var r,t,n,i,o;var l=e.length;var f=new Array(l*2);for(n=0,t=0;t<l;){i=e[t++];if(i<128){f[n++]=i;continue}o=s[i];if(o>4){f[n++]=65533;t+=o-1;continue}i&=o===2?31:o===3?15:7;while(o>1&&t<l){i=i<<6|e[t++]&63;o--}if(o>1){f[n++]=65533;continue}if(i<65536){f[n++]=i}else{i-=65536;f[n++]=55296|i>>10&1023;f[n++]=56320|i&1023}}if(f.length!==n){if(f.subarray){f=f.subarray(0,n)}else{f.length=n}}return a.applyFromCharCode(f)};t.utf8encode=function u(e){if(n.nodebuffer){return i(e,"utf-8")}return l(e)};t.utf8decode=function h(e){if(n.nodebuffer){return a.transformTo("nodebuffer",e).toString("utf-8")}e=a.transformTo(n.uint8array?"uint8array":"array",e);var r=[],t=0,i=e.length,s=65536;while(t<i){var o=f(e,Math.min(t+s,i));if(n.uint8array){r.push(c(e.subarray(t,o)))}else{r.push(c(e.slice(t,o)))}t=o}return r.join("")}},{"./nodeBuffer":11,"./support":17,"./utils":21}],21:[function(e,r,t){"use strict";var a=e("./support");var n=e("./compressions");var i=e("./nodeBuffer");t.string2binary=function(e){var r="";for(var t=0;t<e.length;t++){r+=String.fromCharCode(e.charCodeAt(t)&255)}return r};t.arrayBuffer2Blob=function(e){t.checkSupport("blob");try{return new Blob([e],{type:"application/zip"})}catch(r){try{var a=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;var n=new a;n.append(e);return n.getBlob("application/zip")}catch(r){throw new Error("Bug : can't construct the Blob.")}}};function s(e){return e}function o(e,r){for(var t=0;t<e.length;++t){r[t]=e.charCodeAt(t)&255}return r}function l(e){var r=65536;var a=[],n=e.length,s=t.getTypeOf(e),o=0,l=true;try{switch(s){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,i(0));break;}}catch(f){l=false}if(!l){var c="";for(var u=0;u<e.length;u++){c+=String.fromCharCode(e[u])}return c}while(o<n&&r>1){try{if(s==="array"||s==="nodebuffer"){a.push(String.fromCharCode.apply(null,e.slice(o,Math.min(o+r,n))))}else{a.push(String.fromCharCode.apply(null,e.subarray(o,Math.min(o+r,n))))}o+=r}catch(f){r=Math.floor(r/2)}}return a.join("")}t.applyFromCharCode=l;function f(e,r){for(var t=0;t<e.length;t++){r[t]=e[t]}return r}var c={};c["string"]={string:s,array:function(e){return o(e,new Array(e.length))},arraybuffer:function(e){return c["string"]["uint8array"](e).buffer},uint8array:function(e){return o(e,new Uint8Array(e.length))},nodebuffer:function(e){return o(e,i(e.length))}};c["array"]={string:l,array:s,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return i(e)}};c["arraybuffer"]={string:function(e){return l(new Uint8Array(e))},array:function(e){return f(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:s,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return i(new Uint8Array(e))}};c["uint8array"]={string:l,array:function(e){return f(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:s,nodebuffer:function(e){return i(e)}};c["nodebuffer"]={string:l,array:function(e){return f(e,new Array(e.length))},arraybuffer:function(e){return c["nodebuffer"]["uint8array"](e).buffer},uint8array:function(e){return f(e,new Uint8Array(e.length))},nodebuffer:s};t.transformTo=function(e,r){if(!r){r=""}if(!e){return r}t.checkSupport(e);var a=t.getTypeOf(r);var n=c[a][e](r);return n};t.getTypeOf=function(e){if(typeof e==="string"){return"string"}if(Object.prototype.toString.call(e)==="[object Array]"){return"array"}if(a.nodebuffer&&i.test(e)){return"nodebuffer"}if(a.uint8array&&e instanceof Uint8Array){return"uint8array"}if(a.arraybuffer&&e instanceof ArrayBuffer){return"arraybuffer"}};t.checkSupport=function(e){var r=a[e.toLowerCase()];if(!r){throw new Error(e+" is not supported by this browser")}};t.MAX_VALUE_16BITS=65535;t.MAX_VALUE_32BITS=-1;t.pretty=function(e){var r="",t,a;for(a=0;a<(e||"").length;a++){t=e.charCodeAt(a);r+="\\x"+(t<16?"0":"")+t.toString(16).toUpperCase()}return r};t.findCompression=function(e){for(var r in n){if(!n.hasOwnProperty(r)){continue}if(n[r].magic===e){return n[r]}}return null};t.isRegExp=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"}},{"./compressions":3,"./nodeBuffer":11,"./support":17}],22:[function(e,r,t){"use strict";var a=e("./stringReader");var n=e("./nodeBufferReader");var i=e("./uint8ArrayReader");var s=e("./utils");var o=e("./signature");var l=e("./zipEntry");var f=e("./support");var c=e("./object");function u(e,r){this.files=[];this.loadOptions=r;if(e){this.load(e)}}u.prototype={checkSignature:function(e){var r=this.reader.readString(4);if(r!==e){throw new Error("Corrupted zip or bug : unexpected signature "+"("+s.pretty(r)+", expected "+s.pretty(e)+")")}},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2);this.diskWithCentralDirStart=this.reader.readInt(2);this.centralDirRecordsOnThisDisk=this.reader.readInt(2);this.centralDirRecords=this.reader.readInt(2);this.centralDirSize=this.reader.readInt(4);this.centralDirOffset=this.reader.readInt(4);this.zipCommentLength=this.reader.readInt(2);this.zipComment=this.reader.readString(this.zipCommentLength);this.zipComment=c.utf8decode(this.zipComment)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8);this.versionMadeBy=this.reader.readString(2);this.versionNeeded=this.reader.readInt(2);this.diskNumber=this.reader.readInt(4);this.diskWithCentralDirStart=this.reader.readInt(4);this.centralDirRecordsOnThisDisk=this.reader.readInt(8);this.centralDirRecords=this.reader.readInt(8);this.centralDirSize=this.reader.readInt(8);this.centralDirOffset=this.reader.readInt(8);this.zip64ExtensibleData={};var e=this.zip64EndOfCentralSize-44,r=0,t,a,n;while(r<e){t=this.reader.readInt(2);a=this.reader.readInt(4);n=this.reader.readString(a);this.zip64ExtensibleData[t]={id:t,length:a,value:n}}},readBlockZip64EndOfCentralLocator:function(){this.diskWithZip64CentralDirStart=this.reader.readInt(4);this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8);this.disksCount=this.reader.readInt(4);if(this.disksCount>1){throw new Error("Multi-volumes zip are not supported")}},readLocalFiles:function(){var e,r;for(e=0;e<this.files.length;e++){r=this.files[e];this.reader.setIndex(r.localHeaderOffset);this.checkSignature(o.LOCAL_FILE_HEADER);r.readLocalPart(this.reader);r.handleUTF8()}},readCentralDir:function(){var e;this.reader.setIndex(this.centralDirOffset);while(this.reader.readString(4)===o.CENTRAL_FILE_HEADER){e=new l({zip64:this.zip64},this.loadOptions);e.readCentralPart(this.reader);this.files.push(e)}},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(e===-1){throw new Error("Corrupted zip : can't find end of central directory")}this.reader.setIndex(e);this.checkSignature(o.CENTRAL_DIRECTORY_END);this.readBlockEndOfCentral();if(this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){this.zip64=true;e=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR);if(e===-1){throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator")}this.reader.setIndex(e);this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR);this.readBlockZip64EndOfCentralLocator();this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir);this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END);this.readBlockZip64EndOfCentral()}},prepareReader:function(e){var r=s.getTypeOf(e);if(r==="string"&&!f.uint8array){this.reader=new a(e,this.loadOptions.optimizedBinaryString)}else if(r==="nodebuffer"){this.reader=new n(e)}else{this.reader=new i(s.transformTo("uint8array",e))}},load:function(e){this.prepareReader(e);this.readEndOfCentral();this.readCentralDir();this.readLocalFiles()}};r.exports=u},{"./nodeBufferReader":12,"./object":13,"./signature":14,"./stringReader":15,"./support":17,"./uint8ArrayReader":18,"./utils":21,"./zipEntry":23}],23:[function(e,r,t){"use strict";var a=e("./stringReader");var n=e("./utils");var i=e("./compressedObject");var s=e("./object");function o(e,r){this.options=e;this.loadOptions=r}o.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},prepareCompressedContent:function(e,r,t){return function(){var a=e.index;e.setIndex(r);var n=e.readData(t);e.setIndex(a);return n}},prepareContent:function(e,r,t,a,i){return function(){var e=n.transformTo(a.uncompressInputType,this.getCompressedContent());var r=a.uncompress(e);if(r.length!==i){throw new Error("Bug : uncompressed data size mismatch")}return r}},readLocalPart:function(e){var r,t;e.skip(22);this.fileNameLength=e.readInt(2);t=e.readInt(2);this.fileName=e.readString(this.fileNameLength);e.skip(t);if(this.compressedSize==-1||this.uncompressedSize==-1){throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory "+"(compressedSize == -1 || uncompressedSize == -1)")}r=n.findCompression(this.compressionMethod);if(r===null){throw new Error("Corrupted zip : compression "+n.pretty(this.compressionMethod)+" unknown (inner file : "+this.fileName+")")}this.decompressed=new i;this.decompressed.compressedSize=this.compressedSize;this.decompressed.uncompressedSize=this.uncompressedSize;this.decompressed.crc32=this.crc32;this.decompressed.compressionMethod=this.compressionMethod;this.decompressed.getCompressedContent=this.prepareCompressedContent(e,e.index,this.compressedSize,r);this.decompressed.getContent=this.prepareContent(e,e.index,this.compressedSize,r,this.uncompressedSize);if(this.loadOptions.checkCRC32){this.decompressed=n.transformTo("string",this.decompressed.getContent());if(s.crc32(this.decompressed)!==this.crc32){throw new Error("Corrupted zip : CRC32 mismatch")}}},readCentralPart:function(e){this.versionMadeBy=e.readString(2);this.versionNeeded=e.readInt(2);this.bitFlag=e.readInt(2);this.compressionMethod=e.readString(2);this.date=e.readDate();this.crc32=e.readInt(4);this.compressedSize=e.readInt(4);this.uncompressedSize=e.readInt(4);this.fileNameLength=e.readInt(2);this.extraFieldsLength=e.readInt(2);this.fileCommentLength=e.readInt(2);this.diskNumberStart=e.readInt(2);this.internalFileAttributes=e.readInt(2);this.externalFileAttributes=e.readInt(4);this.localHeaderOffset=e.readInt(4);if(this.isEncrypted()){throw new Error("Encrypted zip are not supported")}this.fileName=e.readString(this.fileNameLength);this.readExtraFields(e);this.parseZIP64ExtraField(e);this.fileComment=e.readString(this.fileCommentLength);this.dir=this.externalFileAttributes&16?true:false},parseZIP64ExtraField:function(e){if(!this.extraFields[1]){return}var r=new a(this.extraFields[1].value);if(this.uncompressedSize===n.MAX_VALUE_32BITS){this.uncompressedSize=r.readInt(8)}if(this.compressedSize===n.MAX_VALUE_32BITS){this.compressedSize=r.readInt(8)}if(this.localHeaderOffset===n.MAX_VALUE_32BITS){this.localHeaderOffset=r.readInt(8)}if(this.diskNumberStart===n.MAX_VALUE_32BITS){this.diskNumberStart=r.readInt(4)}},readExtraFields:function(e){var r=e.index,t,a,n;this.extraFields=this.extraFields||{};while(e.index<r+this.extraFieldsLength){t=e.readInt(2);a=e.readInt(2);n=e.readString(a);this.extraFields[t]={id:t,length:a,value:n}}},handleUTF8:function(){if(this.useUTF8()){this.fileName=s.utf8decode(this.fileName);this.fileComment=s.utf8decode(this.fileComment)}else{var e=this.findExtraFieldUnicodePath();if(e!==null){this.fileName=e}var r=this.findExtraFieldUnicodeComment();if(r!==null){this.fileComment=r}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var r=new a(e.value);if(r.readInt(1)!==1){return null}if(s.crc32(this.fileName)!==r.readInt(4)){return null}return s.utf8decode(r.readString(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var r=new a(e.value);if(r.readInt(1)!==1){return null}if(s.crc32(this.fileComment)!==r.readInt(4)){return null}return s.utf8decode(r.readString(e.length-5));[m
[32m+[m[32m}return null}};r.exports=o},{"./compressedObject":2,"./object":13,"./stringReader":15,"./utils":21}],24:[function(e,r,t){"use strict";var a=e("./lib/utils/common").assign;var n=e("./lib/deflate");var i=e("./lib/inflate");var s=e("./lib/zlib/constants");var o={};a(o,n,i,s);r.exports=o},{"./lib/deflate":25,"./lib/inflate":26,"./lib/utils/common":27,"./lib/zlib/constants":30}],25:[function(e,r,t){"use strict";var a=e("./zlib/deflate.js");var n=e("./utils/common");var i=e("./utils/strings");var s=e("./zlib/messages");var o=e("./zlib/zstream");var l=0;var f=4;var c=0;var u=1;var h=-1;var d=0;var v=8;var p=function(e){this.options=n.assign({level:h,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},e||{});var r=this.options;if(r.raw&&r.windowBits>0){r.windowBits=-r.windowBits}else if(r.gzip&&r.windowBits>0&&r.windowBits<16){r.windowBits+=16}this.err=0;this.msg="";this.ended=false;this.chunks=[];this.strm=new o;this.strm.avail_out=0;var t=a.deflateInit2(this.strm,r.level,r.method,r.windowBits,r.memLevel,r.strategy);if(t!==c){throw new Error(s[t])}if(r.header){a.deflateSetHeader(this.strm,r.header)}};p.prototype.push=function(e,r){var t=this.strm;var s=this.options.chunkSize;var o,h;if(this.ended){return false}h=r===~~r?r:r===true?f:l;if(typeof e==="string"){t.input=i.string2buf(e)}else{t.input=e}t.next_in=0;t.avail_in=t.input.length;do{if(t.avail_out===0){t.output=new n.Buf8(s);t.next_out=0;t.avail_out=s}o=a.deflate(t,h);if(o!==u&&o!==c){this.onEnd(o);this.ended=true;return false}if(t.avail_out===0||t.avail_in===0&&h===f){if(this.options.to==="string"){this.onData(i.buf2binstring(n.shrinkBuf(t.output,t.next_out)))}else{this.onData(n.shrinkBuf(t.output,t.next_out))}}}while((t.avail_in>0||t.avail_out===0)&&o!==u);if(h===f){o=a.deflateEnd(this.strm);this.onEnd(o);this.ended=true;return o===c}return true};p.prototype.onData=function(e){this.chunks.push(e)};p.prototype.onEnd=function(e){if(e===c){if(this.options.to==="string"){this.result=this.chunks.join("")}else{this.result=n.flattenChunks(this.chunks)}}this.chunks=[];this.err=e;this.msg=this.strm.msg};function b(e,r){var t=new p(r);t.push(e,true);if(t.err){throw t.msg}return t.result}function m(e,r){r=r||{};r.raw=true;return b(e,r)}function g(e,r){r=r||{};r.gzip=true;return b(e,r)}t.Deflate=p;t.deflate=b;t.deflateRaw=m;t.gzip=g},{"./utils/common":27,"./utils/strings":28,"./zlib/deflate.js":32,"./zlib/messages":37,"./zlib/zstream":39}],26:[function(e,r,t){"use strict";var a=e("./zlib/inflate.js");var n=e("./utils/common");var i=e("./utils/strings");var s=e("./zlib/constants");var o=e("./zlib/messages");var l=e("./zlib/zstream");var f=e("./zlib/gzheader");var c=function(e){this.options=n.assign({chunkSize:16384,windowBits:0,to:""},e||{});var r=this.options;if(r.raw&&r.windowBits>=0&&r.windowBits<16){r.windowBits=-r.windowBits;if(r.windowBits===0){r.windowBits=-15}}if(r.windowBits>=0&&r.windowBits<16&&!(e&&e.windowBits)){r.windowBits+=32}if(r.windowBits>15&&r.windowBits<48){if((r.windowBits&15)===0){r.windowBits|=15}}this.err=0;this.msg="";this.ended=false;this.chunks=[];this.strm=new l;this.strm.avail_out=0;var t=a.inflateInit2(this.strm,r.windowBits);if(t!==s.Z_OK){throw new Error(o[t])}this.header=new f;a.inflateGetHeader(this.strm,this.header)};c.prototype.push=function(e,r){var t=this.strm;var o=this.options.chunkSize;var l,f;var c,u,h;if(this.ended){return false}f=r===~~r?r:r===true?s.Z_FINISH:s.Z_NO_FLUSH;if(typeof e==="string"){t.input=i.binstring2buf(e)}else{t.input=e}t.next_in=0;t.avail_in=t.input.length;do{if(t.avail_out===0){t.output=new n.Buf8(o);t.next_out=0;t.avail_out=o}l=a.inflate(t,s.Z_NO_FLUSH);if(l!==s.Z_STREAM_END&&l!==s.Z_OK){this.onEnd(l);this.ended=true;return false}if(t.next_out){if(t.avail_out===0||l===s.Z_STREAM_END||t.avail_in===0&&f===s.Z_FINISH){if(this.options.to==="string"){c=i.utf8border(t.output,t.next_out);u=t.next_out-c;h=i.buf2string(t.output,c);t.next_out=u;t.avail_out=o-u;if(u){n.arraySet(t.output,t.output,c,u,0)}this.onData(h)}else{this.onData(n.shrinkBuf(t.output,t.next_out))}}}}while(t.avail_in>0&&l!==s.Z_STREAM_END);if(l===s.Z_STREAM_END){f=s.Z_FINISH}if(f===s.Z_FINISH){l=a.inflateEnd(this.strm);this.onEnd(l);this.ended=true;return l===s.Z_OK}return true};c.prototype.onData=function(e){this.chunks.push(e)};c.prototype.onEnd=function(e){if(e===s.Z_OK){if(this.options.to==="string"){this.result=this.chunks.join("")}else{this.result=n.flattenChunks(this.chunks)}}this.chunks=[];this.err=e;this.msg=this.strm.msg};function u(e,r){var t=new c(r);t.push(e,true);if(t.err){throw t.msg}return t.result}function h(e,r){r=r||{};r.raw=true;return u(e,r)}t.Inflate=c;t.inflate=u;t.inflateRaw=h;t.ungzip=u},{"./utils/common":27,"./utils/strings":28,"./zlib/constants":30,"./zlib/gzheader":33,"./zlib/inflate.js":35,"./zlib/messages":37,"./zlib/zstream":39}],27:[function(e,r,t){"use strict";var a=typeof Uint8Array!=="undefined"&&typeof Uint16Array!=="undefined"&&typeof Int32Array!=="undefined";t.assign=function(e){var r=Array.prototype.slice.call(arguments,1);while(r.length){var t=r.shift();if(!t){continue}if(typeof t!=="object"){throw new TypeError(t+"must be non-object")}for(var a in t){if(t.hasOwnProperty(a)){e[a]=t[a]}}}return e};t.shrinkBuf=function(e,r){if(e.length===r){return e}if(e.subarray){return e.subarray(0,r)}e.length=r;return e};var n={arraySet:function(e,r,t,a,n){if(r.subarray&&e.subarray){e.set(r.subarray(t,t+a),n);return}for(var i=0;i<a;i++){e[n+i]=r[t+i]}},flattenChunks:function(e){var r,t,a,n,i,s;a=0;for(r=0,t=e.length;r<t;r++){a+=e[r].length}s=new Uint8Array(a);n=0;for(r=0,t=e.length;r<t;r++){i=e[r];s.set(i,n);n+=i.length}return s}};var i={arraySet:function(e,r,t,a,n){for(var i=0;i<a;i++){e[n+i]=r[t+i]}},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){if(e){t.Buf8=Uint8Array;t.Buf16=Uint16Array;t.Buf32=Int32Array;t.assign(t,n)}else{t.Buf8=Array;t.Buf16=Array;t.Buf32=Array;t.assign(t,i)}};t.setTyped(a)},{}],28:[function(e,r,t){"use strict";var a=e("./common");var n=true;var i=true;try{String.fromCharCode.apply(null,[0])}catch(s){n=false}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(s){i=false}var o=new a.Buf8(256);for(var l=0;l<256;l++){o[l]=l>=252?6:l>=248?5:l>=240?4:l>=224?3:l>=192?2:1}o[254]=o[254]=1;t.string2buf=function(e){var r,t,n,i,s,o=e.length,l=0;for(i=0;i<o;i++){t=e.charCodeAt(i);if((t&64512)===55296&&i+1<o){n=e.charCodeAt(i+1);if((n&64512)===56320){t=65536+(t-55296<<10)+(n-56320);i++}}l+=t<128?1:t<2048?2:t<65536?3:4}r=new a.Buf8(l);for(s=0,i=0;s<l;i++){t=e.charCodeAt(i);if((t&64512)===55296&&i+1<o){n=e.charCodeAt(i+1);if((n&64512)===56320){t=65536+(t-55296<<10)+(n-56320);i++}}if(t<128){r[s++]=t}else if(t<2048){r[s++]=192|t>>>6;r[s++]=128|t&63}else if(t<65536){r[s++]=224|t>>>12;r[s++]=128|t>>>6&63;r[s++]=128|t&63}else{r[s++]=240|t>>>18;r[s++]=128|t>>>12&63;r[s++]=128|t>>>6&63;r[s++]=128|t&63}}return r};function f(e,r){if(r<65537){if(e.subarray&&i||!e.subarray&&n){return String.fromCharCode.apply(null,a.shrinkBuf(e,r))}}var t="";for(var s=0;s<r;s++){t+=String.fromCharCode(e[s])}return t}t.buf2binstring=function(e){return f(e,e.length)};t.binstring2buf=function(e){var r=new a.Buf8(e.length);for(var t=0,n=r.length;t<n;t++){r[t]=e.charCodeAt(t)}return r};t.buf2string=function(e,r){var t,a,n,i;var s=r||e.length;var l=new Array(s*2);for(a=0,t=0;t<s;){n=e[t++];if(n<128){l[a++]=n;continue}i=o[n];if(i>4){l[a++]=65533;t+=i-1;continue}n&=i===2?31:i===3?15:7;while(i>1&&t<s){n=n<<6|e[t++]&63;i--}if(i>1){l[a++]=65533;continue}if(n<65536){l[a++]=n}else{n-=65536;l[a++]=55296|n>>10&1023;l[a++]=56320|n&1023}}return f(l,a)};t.utf8border=function(e,r){var t;r=r||e.length;if(r>e.length){r=e.length}t=r-1;while(t>=0&&(e[t]&192)===128){t--}if(t<0){return r}if(t===0){return r}return t+o[e[t]]>r?t:r}},{"./common":27}],29:[function(e,r,t){"use strict";function a(e,r,t,a){var n=e&65535|0,i=e>>>16&65535|0,s=0;while(t!==0){s=t>2e3?2e3:t;t-=s;do{n=n+r[a++]|0;i=i+n|0}while(--s);n%=65521;i%=65521}return n|i<<16|0}r.exports=a},{}],30:[function(e,r,t){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],31:[function(e,r,t){"use strict";function a(){var e,r=[];for(var t=0;t<256;t++){e=t;for(var a=0;a<8;a++){e=e&1?3988292384^e>>>1:e>>>1}r[t]=e}return r}var n=a();function i(e,r,t,a){var i=n,s=a+t;e=e^-1;for(var o=a;o<s;o++){e=e>>>8^i[(e^r[o])&255]}return e^-1}r.exports=i},{}],32:[function(e,r,t){"use strict";var a=e("../utils/common");var n=e("./trees");var i=e("./adler32");var s=e("./crc32");var o=e("./messages");var l=0;var f=1;var c=3;var u=4;var h=5;var d=0;var v=1;var p=-2;var b=-3;var m=-5;var g=-1;var E=1;var k=2;var S=3;var w=4;var B=0;var C=2;var _=8;var T=9;var x=15;var I=8;var A=29;var y=256;var R=y+1+A;var D=30;var O=19;var F=2*R+1;var P=15;var N=3;var L=258;var M=L+N+1;var U=32;var H=42;var W=69;var z=73;var V=91;var X=103;var G=113;var j=666;var K=1;var Y=2;var $=3;var Z=4;var Q=3;function J(e,r){e.msg=o[r];return r}function q(e){return(e<<1)-(e>4?9:0)}function ee(e){var r=e.length;while(--r>=0){e[r]=0}}function re(e){var r=e.state;var t=r.pending;if(t>e.avail_out){t=e.avail_out}if(t===0){return}a.arraySet(e.output,r.pending_buf,r.pending_out,t,e.next_out);e.next_out+=t;r.pending_out+=t;e.total_out+=t;e.avail_out-=t;r.pending-=t;if(r.pending===0){r.pending_out=0}}function te(e,r){n._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,r);e.block_start=e.strstart;re(e.strm)}function ae(e,r){e.pending_buf[e.pending++]=r}function ne(e,r){e.pending_buf[e.pending++]=r>>>8&255;e.pending_buf[e.pending++]=r&255}function ie(e,r,t,n){var o=e.avail_in;if(o>n){o=n}if(o===0){return 0}e.avail_in-=o;a.arraySet(r,e.input,e.next_in,o,t);if(e.state.wrap===1){e.adler=i(e.adler,r,o,t)}else if(e.state.wrap===2){e.adler=s(e.adler,r,o,t)}e.next_in+=o;e.total_in+=o;return o}function se(e,r){var t=e.max_chain_length;var a=e.strstart;var n;var i;var s=e.prev_length;var o=e.nice_match;var l=e.strstart>e.w_size-M?e.strstart-(e.w_size-M):0;var f=e.window;var c=e.w_mask;var u=e.prev;var h=e.strstart+L;var d=f[a+s-1];var v=f[a+s];if(e.prev_length>=e.good_match){t>>=2}if(o>e.lookahead){o=e.lookahead}do{n=r;if(f[n+s]!==v||f[n+s-1]!==d||f[n]!==f[a]||f[++n]!==f[a+1]){continue}a+=2;n++;do{}while(f[++a]===f[++n]&&f[++a]===f[++n]&&f[++a]===f[++n]&&f[++a]===f[++n]&&f[++a]===f[++n]&&f[++a]===f[++n]&&f[++a]===f[++n]&&f[++a]===f[++n]&&a<h);i=L-(h-a);a=h-L;if(i>s){e.match_start=r;s=i;if(i>=o){break}d=f[a+s-1];v=f[a+s]}}while((r=u[r&c])>l&&--t!==0);if(s<=e.lookahead){return s}return e.lookahead}function oe(e){var r=e.w_size;var t,n,i,s,o;do{s=e.window_size-e.lookahead-e.strstart;if(e.strstart>=r+(r-M)){a.arraySet(e.window,e.window,r,r,0);e.match_start-=r;e.strstart-=r;e.block_start-=r;n=e.hash_size;t=n;do{i=e.head[--t];e.head[t]=i>=r?i-r:0}while(--n);n=r;t=n;do{i=e.prev[--t];e.prev[t]=i>=r?i-r:0}while(--n);s+=r}if(e.strm.avail_in===0){break}n=ie(e.strm,e.window,e.strstart+e.lookahead,s);e.lookahead+=n;if(e.lookahead+e.insert>=N){o=e.strstart-e.insert;e.ins_h=e.window[o];e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+1])&e.hash_mask;while(e.insert){e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+N-1])&e.hash_mask;e.prev[o&e.w_mask]=e.head[e.ins_h];e.head[e.ins_h]=o;o++;e.insert--;if(e.lookahead+e.insert<N){break}}}}while(e.lookahead<M&&e.strm.avail_in!==0)}function le(e,r){var t=65535;if(t>e.pending_buf_size-5){t=e.pending_buf_size-5}for(;;){if(e.lookahead<=1){oe(e);if(e.lookahead===0&&r===l){return K}if(e.lookahead===0){break}}e.strstart+=e.lookahead;e.lookahead=0;var a=e.block_start+t;if(e.strstart===0||e.strstart>=a){e.lookahead=e.strstart-a;e.strstart=a;te(e,false);if(e.strm.avail_out===0){return K}}if(e.strstart-e.block_start>=e.w_size-M){te(e,false);if(e.strm.avail_out===0){return K}}}e.insert=0;if(r===u){te(e,true);if(e.strm.avail_out===0){return $}return Z}if(e.strstart>e.block_start){te(e,false);if(e.strm.avail_out===0){return K}}return K}function fe(e,r){var t;var a;for(;;){if(e.lookahead<M){oe(e);if(e.lookahead<M&&r===l){return K}if(e.lookahead===0){break}}t=0;if(e.lookahead>=N){e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+N-1])&e.hash_mask;t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h];e.head[e.ins_h]=e.strstart}if(t!==0&&e.strstart-t<=e.w_size-M){e.match_length=se(e,t)}if(e.match_length>=N){a=n._tr_tally(e,e.strstart-e.match_start,e.match_length-N);e.lookahead-=e.match_length;if(e.match_length<=e.max_lazy_match&&e.lookahead>=N){e.match_length--;do{e.strstart++;e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+N-1])&e.hash_mask;t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h];e.head[e.ins_h]=e.strstart}while(--e.match_length!==0);e.strstart++}else{e.strstart+=e.match_length;e.match_length=0;e.ins_h=e.window[e.strstart];e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask}}else{a=n._tr_tally(e,0,e.window[e.strstart]);e.lookahead--;e.strstart++}if(a){te(e,false);if(e.strm.avail_out===0){return K}}}e.insert=e.strstart<N-1?e.strstart:N-1;if(r===u){te(e,true);if(e.strm.avail_out===0){return $}return Z}if(e.last_lit){te(e,false);if(e.strm.avail_out===0){return K}}return Y}function ce(e,r){var t;var a;var i;for(;;){if(e.lookahead<M){oe(e);if(e.lookahead<M&&r===l){return K}if(e.lookahead===0){break}}t=0;if(e.lookahead>=N){e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+N-1])&e.hash_mask;t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h];e.head[e.ins_h]=e.strstart}e.prev_length=e.match_length;e.prev_match=e.match_start;e.match_length=N-1;if(t!==0&&e.prev_length<e.max_lazy_match&&e.strstart-t<=e.w_size-M){e.match_length=se(e,t);if(e.match_length<=5&&(e.strategy===E||e.match_length===N&&e.strstart-e.match_start>4096)){e.match_length=N-1}}if(e.prev_length>=N&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-N;a=n._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-N);e.lookahead-=e.prev_length-1;e.prev_length-=2;do{if(++e.strstart<=i){e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+N-1])&e.hash_mask;t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h];e.head[e.ins_h]=e.strstart}}while(--e.prev_length!==0);e.match_available=0;e.match_length=N-1;e.strstart++;if(a){te(e,false);if(e.strm.avail_out===0){return K}}}else if(e.match_available){a=n._tr_tally(e,0,e.window[e.strstart-1]);if(a){te(e,false)}e.strstart++;e.lookahead--;if(e.strm.avail_out===0){return K}}else{e.match_available=1;e.strstart++;e.lookahead--}}if(e.match_available){a=n._tr_tally(e,0,e.window[e.strstart-1]);e.match_available=0}e.insert=e.strstart<N-1?e.strstart:N-1;if(r===u){te(e,true);if(e.strm.avail_out===0){return $}return Z}if(e.last_lit){te(e,false);if(e.strm.avail_out===0){return K}}return Y}function ue(e,r){var t;var a;var i,s;var o=e.window;for(;;){if(e.lookahead<=L){oe(e);if(e.lookahead<=L&&r===l){return K}if(e.lookahead===0){break}}e.match_length=0;if(e.lookahead>=N&&e.strstart>0){i=e.strstart-1;a=o[i];if(a===o[++i]&&a===o[++i]&&a===o[++i]){s=e.strstart+L;do{}while(a===o[++i]&&a===o[++i]&&a===o[++i]&&a===o[++i]&&a===o[++i]&&a===o[++i]&&a===o[++i]&&a===o[++i]&&i<s);e.match_length=L-(s-i);if(e.match_length>e.lookahead){e.match_length=e.lookahead}}}if(e.match_length>=N){t=n._tr_tally(e,1,e.match_length-N);e.lookahead-=e.match_length;e.strstart+=e.match_length;e.match_length=0}else{t=n._tr_tally(e,0,e.window[e.strstart]);e.lookahead--;e.strstart++}if(t){te(e,false);if(e.strm.avail_out===0){return K}}}e.insert=0;if(r===u){te(e,true);if(e.strm.avail_out===0){return $}return Z}if(e.last_lit){te(e,false);if(e.strm.avail_out===0){return K}}return Y}function he(e,r){var t;for(;;){if(e.lookahead===0){oe(e);if(e.lookahead===0){if(r===l){return K}break}}e.match_length=0;t=n._tr_tally(e,0,e.window[e.strstart]);e.lookahead--;e.strstart++;if(t){te(e,false);if(e.strm.avail_out===0){return K}}}e.insert=0;if(r===u){te(e,true);if(e.strm.avail_out===0){return $}return Z}if(e.last_lit){te(e,false);if(e.strm.avail_out===0){return K}}return Y}var de=function(e,r,t,a,n){this.good_length=e;this.max_lazy=r;this.nice_length=t;this.max_chain=a;this.func=n};var ve;ve=[new de(0,0,0,0,le),new de(4,4,8,4,fe),new de(4,5,16,8,fe),new de(4,6,32,32,fe),new de(4,4,16,16,ce),new de(8,16,32,32,ce),new de(8,16,128,128,ce),new de(8,32,128,256,ce),new de(32,128,258,1024,ce),new de(32,258,258,4096,ce)];function pe(e){e.window_size=2*e.w_size;ee(e.head);e.max_lazy_match=ve[e.level].max_lazy;e.good_match=ve[e.level].good_length;e.nice_match=ve[e.level].nice_length;e.max_chain_length=ve[e.level].max_chain;e.strstart=0;e.block_start=0;e.lookahead=0;e.insert=0;e.match_length=e.prev_length=N-1;e.match_available=0;e.ins_h=0}function be(){this.strm=null;this.status=0;this.pending_buf=null;this.pending_buf_size=0;this.pending_out=0;this.pending=0;this.wrap=0;this.gzhead=null;this.gzindex=0;this.method=_;this.last_flush=-1;this.w_size=0;this.w_bits=0;this.w_mask=0;this.window=null;this.window_size=0;this.prev=null;this.head=null;this.ins_h=0;this.hash_size=0;this.hash_bits=0;this.hash_mask=0;this.hash_shift=0;this.block_start=0;this.match_length=0;this.prev_match=0;this.match_available=0;this.strstart=0;this.match_start=0;this.lookahead=0;this.prev_length=0;this.max_chain_length=0;this.max_lazy_match=0;this.level=0;this.strategy=0;this.good_match=0;this.nice_match=0;this.dyn_ltree=new a.Buf16(F*2);this.dyn_dtree=new a.Buf16((2*D+1)*2);this.bl_tree=new a.Buf16((2*O+1)*2);ee(this.dyn_ltree);ee(this.dyn_dtree);ee(this.bl_tree);this.l_desc=null;this.d_desc=null;this.bl_desc=null;this.bl_count=new a.Buf16(P+1);this.heap=new a.Buf16(2*R+1);ee(this.heap);this.heap_len=0;this.heap_max=0;this.depth=new a.Buf16(2*R+1);ee(this.depth);this.l_buf=0;this.lit_bufsize=0;this.last_lit=0;this.d_buf=0;this.opt_len=0;this.static_len=0;this.matches=0;this.insert=0;this.bi_buf=0;this.bi_valid=0}function me(e){var r;if(!e||!e.state){return J(e,p)}e.total_in=e.total_out=0;e.data_type=C;r=e.state;r.pending=0;r.pending_out=0;if(r.wrap<0){r.wrap=-r.wrap}r.status=r.wrap?H:G;e.adler=r.wrap===2?0:1;r.last_flush=l;n._tr_init(r);return d}function ge(e){var r=me(e);if(r===d){pe(e.state)}return r}function Ee(e,r){if(!e||!e.state){return p}if(e.state.wrap!==2){return p}e.state.gzhead=r;return d}function ke(e,r,t,n,i,s){if(!e){return p}var o=1;if(r===g){r=6}if(n<0){o=0;n=-n}else if(n>15){o=2;n-=16}if(i<1||i>T||t!==_||n<8||n>15||r<0||r>9||s<0||s>w){return J(e,p)}if(n===8){n=9}var l=new be;e.state=l;l.strm=e;l.wrap=o;l.gzhead=null;l.w_bits=n;l.w_size=1<<l.w_bits;l.w_mask=l.w_size-1;l.hash_bits=i+7;l.hash_size=1<<l.hash_bits;l.hash_mask=l.hash_size-1;l.hash_shift=~~((l.hash_bits+N-1)/N);l.window=new a.Buf8(l.w_size*2);l.head=new a.Buf16(l.hash_size);l.prev=new a.Buf16(l.w_size);l.lit_bufsize=1<<i+6;l.pending_buf_size=l.lit_bufsize*4;l.pending_buf=new a.Buf8(l.pending_buf_size);l.d_buf=l.lit_bufsize>>1;l.l_buf=(1+2)*l.lit_bufsize;l.level=r;l.strategy=s;l.method=t;return ge(e)}function Se(e,r){return ke(e,r,_,x,I,B)}function we(e,r){var t,a;var i,o;if(!e||!e.state||r>h||r<0){return e?J(e,p):p}a=e.state;if(!e.output||!e.input&&e.avail_in!==0||a.status===j&&r!==u){return J(e,e.avail_out===0?m:p)}a.strm=e;t=a.last_flush;a.last_flush=r;if(a.status===H){if(a.wrap===2){e.adler=0;ae(a,31);ae(a,139);ae(a,8);if(!a.gzhead){ae(a,0);ae(a,0);ae(a,0);ae(a,0);ae(a,0);ae(a,a.level===9?2:a.strategy>=k||a.level<2?4:0);ae(a,Q);a.status=G}else{ae(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(!a.gzhead.extra?0:4)+(!a.gzhead.name?0:8)+(!a.gzhead.comment?0:16));ae(a,a.gzhead.time&255);ae(a,a.gzhead.time>>8&255);ae(a,a.gzhead.time>>16&255);ae(a,a.gzhead.time>>24&255);ae(a,a.level===9?2:a.strategy>=k||a.level<2?4:0);ae(a,a.gzhead.os&255);if(a.gzhead.extra&&a.gzhead.extra.length){ae(a,a.gzhead.extra.length&255);ae(a,a.gzhead.extra.length>>8&255)}if(a.gzhead.hcrc){e.adler=s(e.adler,a.pending_buf,a.pending,0)}a.gzindex=0;a.status=W}}else{var b=_+(a.w_bits-8<<4)<<8;var g=-1;if(a.strategy>=k||a.level<2){g=0}else if(a.level<6){g=1}else if(a.level===6){g=2}else{g=3}b|=g<<6;if(a.strstart!==0){b|=U}b+=31-b%31;a.status=G;ne(a,b);if(a.strstart!==0){ne(a,e.adler>>>16);ne(a,e.adler&65535)}e.adler=1}}if(a.status===W){if(a.gzhead.extra){i=a.pending;while(a.gzindex<(a.gzhead.extra.length&65535)){if(a.pending===a.pending_buf_size){if(a.gzhead.hcrc&&a.pending>i){e.adler=s(e.adler,a.pending_buf,a.pending-i,i)}re(e);i=a.pending;if(a.pending===a.pending_buf_size){break}}ae(a,a.gzhead.extra[a.gzindex]&255);a.gzindex++}if(a.gzhead.hcrc&&a.pending>i){e.adler=s(e.adler,a.pending_buf,a.pending-i,i)}if(a.gzindex===a.gzhead.extra.length){a.gzindex=0;a.status=z}}else{a.status=z}}if(a.status===z){if(a.gzhead.name){i=a.pending;do{if(a.pending===a.pending_buf_size){if(a.gzhead.hcrc&&a.pending>i){e.adler=s(e.adler,a.pending_buf,a.pending-i,i)}re(e);i=a.pending;if(a.pending===a.pending_buf_size){o=1;break}}if(a.gzindex<a.gzhead.name.length){o=a.gzhead.name.charCodeAt(a.gzindex++)&255}else{o=0}ae(a,o)}while(o!==0);if(a.gzhead.hcrc&&a.pending>i){e.adler=s(e.adler,a.pending_buf,a.pending-i,i)}if(o===0){a.gzindex=0;a.status=V}}else{a.status=V}}if(a.status===V){if(a.gzhead.comment){i=a.pending;do{if(a.pending===a.pending_buf_size){if(a.gzhead.hcrc&&a.pending>i){e.adler=s(e.adler,a.pending_buf,a.pending-i,i)}re(e);i=a.pending;if(a.pending===a.pending_buf_size){o=1;break}}if(a.gzindex<a.gzhead.comment.length){o=a.gzhead.comment.charCodeAt(a.gzindex++)&255}else{o=0}ae(a,o)}while(o!==0);if(a.gzhead.hcrc&&a.pending>i){e.adler=s(e.adler,a.pending_buf,a.pending-i,i)}if(o===0){a.status=X}}else{a.status=X}}if(a.status===X){if(a.gzhead.hcrc){if(a.pending+2>a.pending_buf_size){re(e)}if(a.pending+2<=a.pending_buf_size){ae(a,e.adler&255);ae(a,e.adler>>8&255);e.adler=0;a.status=G}}else{a.status=G}}if(a.pending!==0){re(e);if(e.avail_out===0){a.last_flush=-1;return d}}else if(e.avail_in===0&&q(r)<=q(t)&&r!==u){return J(e,m)}if(a.status===j&&e.avail_in!==0){return J(e,m)}if(e.avail_in!==0||a.lookahead!==0||r!==l&&a.status!==j){var E=a.strategy===k?he(a,r):a.strategy===S?ue(a,r):ve[a.level].func(a,r);if(E===$||E===Z){a.status=j}if(E===K||E===$){if(e.avail_out===0){a.last_flush=-1}return d}if(E===Y){if(r===f){n._tr_align(a)}else if(r!==h){n._tr_stored_block(a,0,0,false);if(r===c){ee(a.head);if(a.lookahead===0){a.strstart=0;a.block_start=0;a.insert=0}}}re(e);if(e.avail_out===0){a.last_flush=-1;return d}}}if(r!==u){return d}if(a.wrap<=0){return v}if(a.wrap===2){ae(a,e.adler&255);ae(a,e.adler>>8&255);ae(a,e.adler>>16&255);ae(a,e.adler>>24&255);ae(a,e.total_in&255);ae(a,e.total_in>>8&255);ae(a,e.total_in>>16&255);ae(a,e.total_in>>24&255)}else{ne(a,e.adler>>>16);ne(a,e.adler&65535)}re(e);if(a.wrap>0){a.wrap=-a.wrap}return a.pending!==0?d:v}function Be(e){var r;if(!e||!e.state){return p}r=e.state.status;if(r!==H&&r!==W&&r!==z&&r!==V&&r!==X&&r!==G&&r!==j){return J(e,p)}e.state=null;return r===G?J(e,b):d}t.deflateInit=Se;t.deflateInit2=ke;t.deflateReset=ge;t.deflateResetKeep=me;t.deflateSetHeader=Ee;t.deflate=we;t.deflateEnd=Be;t.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./messages":37,"./trees":38}],33:[function(e,r,t){"use strict";function a(){this.text=0;this.time=0;this.xflags=0;this.os=0;this.extra=null;this.extra_len=0;this.name="";this.comment="";this.hcrc=0;this.done=false}r.exports=a},{}],34:[function(e,r,t){"use strict";var a=30;var n=12;r.exports=function i(e,r){var t;var i;var s;var o;var l;var f;var c;var u;var h;var d;var v;var p;var b;var m;var g;var E;var k;var S;var w;var B;var C;var _;var T;var x,I;t=e.state;i=e.next_in;x=e.input;s=i+(e.avail_in-5);o=e.next_out;I=e.output;l=o-(r-e.avail_out);f=o+(e.avail_out-257);c=t.dmax;u=t.wsize;h=t.whave;d=t.wnext;v=t.window;p=t.hold;b=t.bits;m=t.lencode;g=t.distcode;E=(1<<t.lenbits)-1;k=(1<<t.distbits)-1;e:do{if(b<15){p+=x[i++]<<b;b+=8;p+=x[i++]<<b;b+=8}S=m[p&E];r:for(;;){w=S>>>24;p>>>=w;b-=w;w=S>>>16&255;if(w===0){I[o++]=S&65535}else if(w&16){B=S&65535;w&=15;if(w){if(b<w){p+=x[i++]<<b;b+=8}B+=p&(1<<w)-1;p>>>=w;b-=w}if(b<15){p+=x[i++]<<b;b+=8;p+=x[i++]<<b;b+=8}S=g[p&k];t:for(;;){w=S>>>24;p>>>=w;b-=w;w=S>>>16&255;if(w&16){C=S&65535;w&=15;if(b<w){p+=x[i++]<<b;b+=8;if(b<w){p+=x[i++]<<b;b+=8}}C+=p&(1<<w)-1;if(C>c){e.msg="invalid distance too far back";t.mode=a;break e}p>>>=w;b-=w;w=o-l;if(C>w){w=C-w;if(w>h){if(t.sane){e.msg="invalid distance too far back";t.mode=a;break e}}_=0;T=v;if(d===0){_+=u-w;if(w<B){B-=w;do{I[o++]=v[_++]}while(--w);_=o-C;T=I}}else if(d<w){_+=u+d-w;w-=d;if(w<B){B-=w;do{I[o++]=v[_++]}while(--w);_=0;if(d<B){w=d;B-=w;do{I[o++]=v[_++]}while(--w);_=o-C;T=I}}}else{_+=d-w;if(w<B){B-=w;do{I[o++]=v[_++]}while(--w);_=o-C;T=I}}while(B>2){I[o++]=T[_++];I[o++]=T[_++];I[o++]=T[_++];B-=3}if(B){I[o++]=T[_++];if(B>1){I[o++]=T[_++]}}}else{_=o-C;do{I[o++]=I[_++];I[o++]=I[_++];I[o++]=I[_++];B-=3}while(B>2);if(B){I[o++]=I[_++];if(B>1){I[o++]=I[_++]}}}}else if((w&64)===0){S=g[(S&65535)+(p&(1<<w)-1)];continue t}else{e.msg="invalid distance code";t.mode=a;break e}break}}else if((w&64)===0){S=m[(S&65535)+(p&(1<<w)-1)];continue r}else if(w&32){t.mode=n;break e}else{e.msg="invalid literal/length code";t.mode=a;break e}break}}while(i<s&&o<f);B=b>>3;i-=B;b-=B<<3;p&=(1<<b)-1;e.next_in=i;e.next_out=o;e.avail_in=i<s?5+(s-i):5-(i-s);e.avail_out=o<f?257+(f-o):257-(o-f);t.hold=p;t.bits=b;return}},{}],35:[function(e,r,t){"use strict";var a=e("../utils/common");var n=e("./adler32");var i=e("./crc32");var s=e("./inffast");var o=e("./inftrees");var l=0;var f=1;var c=2;var u=4;var h=5;var d=6;var v=0;var p=1;var b=2;var m=-2;var g=-3;var E=-4;var k=-5;var S=8;var w=1;var B=2;var C=3;var _=4;var T=5;var x=6;var I=7;var A=8;var y=9;var R=10;var D=11;var O=12;var F=13;var P=14;var N=15;var L=16;var M=17;var U=18;var H=19;var W=20;var z=21;var V=22;var X=23;var G=24;var j=25;var K=26;var Y=27;var $=28;var Z=29;var Q=30;var J=31;var q=32;var ee=852;var re=592;var te=15;var ae=te;function ne(e){return(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24)}function ie(){this.mode=0;this.last=false;this.wrap=0;this.havedict=false;this.flags=0;this.dmax=0;this.check=0;this.total=0;this.head=null;this.wbits=0;this.wsize=0;this.whave=0;this.wnext=0;this.window=null;this.hold=0;this.bits=0;this.length=0;this.offset=0;this.extra=0;this.lencode=null;this.distcode=null;this.lenbits=0;this.distbits=0;this.ncode=0;this.nlen=0;this.ndist=0;this.have=0;this.next=null;this.lens=new a.Buf16(320);this.work=new a.Buf16(288);this.lendyn=null;this.distdyn=null;this.sane=0;this.back=0;this.was=0}function se(e){var r;if(!e||!e.state){return m}r=e.state;e.total_in=e.total_out=r.total=0;e.msg="";if(r.wrap){e.adler=r.wrap&1}r.mode=w;r.last=0;r.havedict=0;r.dmax=32768;r.head=null;r.hold=0;r.bits=0;r.lencode=r.lendyn=new a.Buf32(ee);r.distcode=r.distdyn=new a.Buf32(re);r.sane=1;r.back=-1;return v}function oe(e){var r;if(!e||!e.state){return m}r=e.state;r.wsize=0;r.whave=0;r.wnext=0;return se(e)}function le(e,r){var t;var a;if(!e||!e.state){return m}a=e.state;if(r<0){t=0;r=-r}else{t=(r>>4)+1;if(r<48){r&=15}}if(r&&(r<8||r>15)){return m}if(a.window!==null&&a.wbits!==r){a.window=null}a.wrap=t;a.wbits=r;return oe(e)}function fe(e,r){var t;var a;if(!e){return m}a=new ie;e.state=a;a.window=null;t=le(e,r);if(t!==v){e.state=null}return t}function ce(e){return fe(e,ae)}var ue=true;var he,de;function ve(e){if(ue){var r;he=new a.Buf32(512);de=new a.Buf32(32);r=0;while(r<144){e.lens[r++]=8}while(r<256){e.lens[r++]=9}while(r<280){e.lens[r++]=7}while(r<288){e.lens[r++]=8}o(f,e.lens,0,288,he,0,e.work,{bits:9});r=0;while(r<32){e.lens[r++]=5}o(c,e.lens,0,32,de,0,e.work,{bits:5});ue=false}e.lencode=he;e.lenbits=9;e.distcode=de;e.distbits=5}function pe(e,r,t,n){var i;var s=e.state;if(s.window===null){s.wsize=1<<s.wbits;s.wnext=0;s.whave=0;s.window=new a.Buf8(s.wsize)}if(n>=s.wsize){a.arraySet(s.window,r,t-s.wsize,s.wsize,0);s.wnext=0;s.whave=s.wsize}else{i=s.wsize-s.wnext;if(i>n){i=n}a.arraySet(s.window,r,t-n,i,s.wnext);n-=i;if(n){a.arraySet(s.window,r,t-n,n,0);s.wnext=n;s.whave=s.wsize}else{s.wnext+=i;if(s.wnext===s.wsize){s.wnext=0}if(s.whave<s.wsize){s.whave+=i}}}return 0}function be(e,r){var t;var ee,re;var te;var ae;var ie,se;var oe;var le;var fe,ce;var ue;var he;var de;var be=0;var me,ge,Ee;var ke,Se,we;var Be;var Ce;var _e=new a.Buf8(4);var Te;var xe;var Ie=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0){return m}t=e.state;if(t.mode===O){t.mode=F}ae=e.next_out;re=e.output;se=e.avail_out;te=e.next_in;ee=e.input;ie=e.avail_in;oe=t.hold;le=t.bits;fe=ie;ce=se;Ce=v;e:for(;;){switch(t.mode){case w:if(t.wrap===0){t.mode=F;break}while(le<16){if(ie===0){break e}ie--;oe+=ee[te++]<<le;le+=8}if(t.wrap&2&&oe===35615){t.check=0;_e[0]=oe&255;_e[1]=oe>>>8&255;t.check=i(t.check,_e,2,0);oe=0;le=0;t.mode=B;break}t.flags=0;if(t.head){t.head.done=false}if(!(t.wrap&1)||(((oe&255)<<8)+(oe>>8))%31){e.msg="incorrect header check";t.mode=Q;break}if((oe&15)!==S){e.msg="unknown compression method";t.mode=Q;break}oe>>>=4;le-=4;Be=(oe&15)+8;if(t.wbits===0){t.wbits=Be}else if(Be>t.wbits){e.msg="invalid window size";t.mode=Q;break}t.dmax=1<<Be;e.adler=t.check=1;t.mode=oe&512?R:O;oe=0;le=0;break;case B:while(le<16){if(ie===0){break e}ie--;oe+=ee[te++]<<le;le+=8}t.flags=oe;if((t.flags&255)!==S){e.msg="unknown compression method";t.mode=Q;break}if(t.flags&57344){e.msg="unknown header flags set";t.mode=Q;break}if(t.head){t.head.text=oe>>8&1}if(t.flags&512){_e[0]=oe&255;_e[1]=oe>>>8&255;t.check=i(t.check,_e,2,0)}oe=0;le=0;t.mode=C;case C:while(le<32){if(ie===0){break e}ie--;oe+=ee[te++]<<le;le+=8}if(t.head){t.head.time=oe}if(t.flags&512){_e[0]=oe&255;_e[1]=oe>>>8&255;_e[2]=oe>>>16&255;_e[3]=oe>>>24&255;t.check=i(t.check,_e,4,0)}oe=0;le=0;t.mode=_;case _:while(le<16){if(ie===0){break e}ie--;oe+=ee[te++]<<le;le+=8}if(t.head){t.head.xflags=oe&255;t.head.os=oe>>8}if(t.flags&512){_e[0]=oe&255;_e[1]=oe>>>8&255;t.check=i(t.check,_e,2,0)}oe=0;le=0;t.mode=T;case T:if(t.flags&1024){while(le<16){if(ie===0){break e}ie--;oe+=ee[te++]<<le;le+=8}t.length=oe;if(t.head){t.head.extra_len=oe}if(t.flags&512){_e[0]=oe&255;_e[1]=oe>>>8&255;t.check=i(t.check,_e,2,0)}oe=0;le=0}else if(t.head){t.head.extra=null}t.mode=x;case x:if(t.flags&1024){ue=t.length;if(ue>ie){ue=ie}if(ue){if(t.head){Be=t.head.extra_len-t.length;if(!t.head.extra){t.head.extra=new Array(t.head.extra_len)}a.arraySet(t.head.extra,ee,te,ue,Be)}if(t.flags&512){t.check=i(t.check,ee,ue,te)}ie-=ue;te+=ue;t.length-=ue}if(t.length){break e}}t.length=0;t.mode=I;case I:if(t.flags&2048){if(ie===0){break e}ue=0;do{Be=ee[te+ue++];if(t.head&&Be&&t.length<65536){t.head.name+=String.fromCharCode(Be)}}while(Be&&ue<ie);if(t.flags&512){t.check=i(t.check,ee,ue,te)}ie-=ue;te+=ue;if(Be){break e}}else if(t.head){t.head.name=null}t.length=0;t.mode=A;case A:if(t.flags&4096){if(ie===0){break e}ue=0;do{Be=ee[te+ue++];if(t.head&&Be&&t.length<65536){t.head.comment+=String.fromCharCode(Be)}}while(Be&&ue<ie);if(t.flags&512){t.check=i(t.check,ee,ue,te)}ie-=ue;te+=ue;if(Be){break e}}else if(t.head){t.head.comment=null}t.mode=y;case y:if(t.flags&512){while(le<16){if(ie===0){break e}ie--;oe+=ee[te++]<<le;le+=8}if(oe!==(t.check&65535)){e.msg="header crc mismatch";t.mode=Q;break}oe=0;le=0}if(t.head){t.head.hcrc=t.flags>>9&1;t.head.done=true}e.adler=t.check=0;t.mode=O;break;case R:while(le<32){if(ie===0){break e}ie--;oe+=ee[te++]<<le;le+=8}e.adler=t.check=ne(oe);oe=0;le=0;t.mode=D;case D:if(t.havedict===0){e.next_out=ae;e.avail_out=se;e.next_in=te;e.avail_in=ie;t.hold=oe;t.bits=le;return b}e.adler=t.check=1;t.mode=O;case O:if(r===h||r===d){break e};case F:if(t.last){oe>>>=le&7;le-=le&7;t.mode=Y;break}while(le<3){if(ie===0){break e}ie--;oe+=ee[te++]<<le;le+=8}t.last=oe&1;oe>>>=1;le-=1;switch(oe&3){case 0:t.mode=P;break;case 1:ve(t);t.mode=W;if(r===d){oe>>>=2;le-=2;break e}break;case 2:t.mode=M;break;case 3:e.msg="invalid block type";t.mode=Q;}oe>>>=2;le-=2;break;case P:[m
[32m+[m[32moe>>>=le&7;le-=le&7;while(le<32){if(ie===0){break e}ie--;oe+=ee[te++]<<le;le+=8}if((oe&65535)!==(oe>>>16^65535)){e.msg="invalid stored block lengths";t.mode=Q;break}t.length=oe&65535;oe=0;le=0;t.mode=N;if(r===d){break e};case N:t.mode=L;case L:ue=t.length;if(ue){if(ue>ie){ue=ie}if(ue>se){ue=se}if(ue===0){break e}a.arraySet(re,ee,te,ue,ae);ie-=ue;te+=ue;se-=ue;ae+=ue;t.length-=ue;break}t.mode=O;break;case M:while(le<14){if(ie===0){break e}ie--;oe+=ee[te++]<<le;le+=8}t.nlen=(oe&31)+257;oe>>>=5;le-=5;t.ndist=(oe&31)+1;oe>>>=5;le-=5;t.ncode=(oe&15)+4;oe>>>=4;le-=4;if(t.nlen>286||t.ndist>30){e.msg="too many length or distance symbols";t.mode=Q;break}t.have=0;t.mode=U;case U:while(t.have<t.ncode){while(le<3){if(ie===0){break e}ie--;oe+=ee[te++]<<le;le+=8}t.lens[Ie[t.have++]]=oe&7;oe>>>=3;le-=3}while(t.have<19){t.lens[Ie[t.have++]]=0}t.lencode=t.lendyn;t.lenbits=7;Te={bits:t.lenbits};Ce=o(l,t.lens,0,19,t.lencode,0,t.work,Te);t.lenbits=Te.bits;if(Ce){e.msg="invalid code lengths set";t.mode=Q;break}t.have=0;t.mode=H;case H:while(t.have<t.nlen+t.ndist){for(;;){be=t.lencode[oe&(1<<t.lenbits)-1];me=be>>>24;ge=be>>>16&255;Ee=be&65535;if(me<=le){break}if(ie===0){break e}ie--;oe+=ee[te++]<<le;le+=8}if(Ee<16){oe>>>=me;le-=me;t.lens[t.have++]=Ee}else{if(Ee===16){xe=me+2;while(le<xe){if(ie===0){break e}ie--;oe+=ee[te++]<<le;le+=8}oe>>>=me;le-=me;if(t.have===0){e.msg="invalid bit length repeat";t.mode=Q;break}Be=t.lens[t.have-1];ue=3+(oe&3);oe>>>=2;le-=2}else if(Ee===17){xe=me+3;while(le<xe){if(ie===0){break e}ie--;oe+=ee[te++]<<le;le+=8}oe>>>=me;le-=me;Be=0;ue=3+(oe&7);oe>>>=3;le-=3}else{xe=me+7;while(le<xe){if(ie===0){break e}ie--;oe+=ee[te++]<<le;le+=8}oe>>>=me;le-=me;Be=0;ue=11+(oe&127);oe>>>=7;le-=7}if(t.have+ue>t.nlen+t.ndist){e.msg="invalid bit length repeat";t.mode=Q;break}while(ue--){t.lens[t.have++]=Be}}}if(t.mode===Q){break}if(t.lens[256]===0){e.msg="invalid code -- missing end-of-block";t.mode=Q;break}t.lenbits=9;Te={bits:t.lenbits};Ce=o(f,t.lens,0,t.nlen,t.lencode,0,t.work,Te);t.lenbits=Te.bits;if(Ce){e.msg="invalid literal/lengths set";t.mode=Q;break}t.distbits=6;t.distcode=t.distdyn;Te={bits:t.distbits};Ce=o(c,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,Te);t.distbits=Te.bits;if(Ce){e.msg="invalid distances set";t.mode=Q;break}t.mode=W;if(r===d){break e};case W:t.mode=z;case z:if(ie>=6&&se>=258){e.next_out=ae;e.avail_out=se;e.next_in=te;e.avail_in=ie;t.hold=oe;t.bits=le;s(e,ce);ae=e.next_out;re=e.output;se=e.avail_out;te=e.next_in;ee=e.input;ie=e.avail_in;oe=t.hold;le=t.bits;if(t.mode===O){t.back=-1}break}t.back=0;for(;;){be=t.lencode[oe&(1<<t.lenbits)-1];me=be>>>24;ge=be>>>16&255;Ee=be&65535;if(me<=le){break}if(ie===0){break e}ie--;oe+=ee[te++]<<le;le+=8}if(ge&&(ge&240)===0){ke=me;Se=ge;we=Ee;for(;;){be=t.lencode[we+((oe&(1<<ke+Se)-1)>>ke)];me=be>>>24;ge=be>>>16&255;Ee=be&65535;if(ke+me<=le){break}if(ie===0){break e}ie--;oe+=ee[te++]<<le;le+=8}oe>>>=ke;le-=ke;t.back+=ke}oe>>>=me;le-=me;t.back+=me;t.length=Ee;if(ge===0){t.mode=K;break}if(ge&32){t.back=-1;t.mode=O;break}if(ge&64){e.msg="invalid literal/length code";t.mode=Q;break}t.extra=ge&15;t.mode=V;case V:if(t.extra){xe=t.extra;while(le<xe){if(ie===0){break e}ie--;oe+=ee[te++]<<le;le+=8}t.length+=oe&(1<<t.extra)-1;oe>>>=t.extra;le-=t.extra;t.back+=t.extra}t.was=t.length;t.mode=X;case X:for(;;){be=t.distcode[oe&(1<<t.distbits)-1];me=be>>>24;ge=be>>>16&255;Ee=be&65535;if(me<=le){break}if(ie===0){break e}ie--;oe+=ee[te++]<<le;le+=8}if((ge&240)===0){ke=me;Se=ge;we=Ee;for(;;){be=t.distcode[we+((oe&(1<<ke+Se)-1)>>ke)];me=be>>>24;ge=be>>>16&255;Ee=be&65535;if(ke+me<=le){break}if(ie===0){break e}ie--;oe+=ee[te++]<<le;le+=8}oe>>>=ke;le-=ke;t.back+=ke}oe>>>=me;le-=me;t.back+=me;if(ge&64){e.msg="invalid distance code";t.mode=Q;break}t.offset=Ee;t.extra=ge&15;t.mode=G;case G:if(t.extra){xe=t.extra;while(le<xe){if(ie===0){break e}ie--;oe+=ee[te++]<<le;le+=8}t.offset+=oe&(1<<t.extra)-1;oe>>>=t.extra;le-=t.extra;t.back+=t.extra}if(t.offset>t.dmax){e.msg="invalid distance too far back";t.mode=Q;break}t.mode=j;case j:if(se===0){break e}ue=ce-se;if(t.offset>ue){ue=t.offset-ue;if(ue>t.whave){if(t.sane){e.msg="invalid distance too far back";t.mode=Q;break}}if(ue>t.wnext){ue-=t.wnext;he=t.wsize-ue}else{he=t.wnext-ue}if(ue>t.length){ue=t.length}de=t.window}else{de=re;he=ae-t.offset;ue=t.length}if(ue>se){ue=se}se-=ue;t.length-=ue;do{re[ae++]=de[he++]}while(--ue);if(t.length===0){t.mode=z}break;case K:if(se===0){break e}re[ae++]=t.length;se--;t.mode=z;break;case Y:if(t.wrap){while(le<32){if(ie===0){break e}ie--;oe|=ee[te++]<<le;le+=8}ce-=se;e.total_out+=ce;t.total+=ce;if(ce){e.adler=t.check=t.flags?i(t.check,re,ce,ae-ce):n(t.check,re,ce,ae-ce)}ce=se;if((t.flags?oe:ne(oe))!==t.check){e.msg="incorrect data check";t.mode=Q;break}oe=0;le=0}t.mode=$;case $:if(t.wrap&&t.flags){while(le<32){if(ie===0){break e}ie--;oe+=ee[te++]<<le;le+=8}if(oe!==(t.total&4294967295)){e.msg="incorrect length check";t.mode=Q;break}oe=0;le=0}t.mode=Z;case Z:Ce=p;break e;case Q:Ce=g;break e;case J:return E;case q:;default:return m;}}e.next_out=ae;e.avail_out=se;e.next_in=te;e.avail_in=ie;t.hold=oe;t.bits=le;if(t.wsize||ce!==e.avail_out&&t.mode<Q&&(t.mode<Y||r!==u)){if(pe(e,e.output,e.next_out,ce-e.avail_out)){t.mode=J;return E}}fe-=e.avail_in;ce-=e.avail_out;e.total_in+=fe;e.total_out+=ce;t.total+=ce;if(t.wrap&&ce){e.adler=t.check=t.flags?i(t.check,re,ce,e.next_out-ce):n(t.check,re,ce,e.next_out-ce)}e.data_type=t.bits+(t.last?64:0)+(t.mode===O?128:0)+(t.mode===W||t.mode===N?256:0);if((fe===0&&ce===0||r===u)&&Ce===v){Ce=k}return Ce}function me(e){if(!e||!e.state){return m}var r=e.state;if(r.window){r.window=null}e.state=null;return v}function ge(e,r){var t;if(!e||!e.state){return m}t=e.state;if((t.wrap&2)===0){return m}t.head=r;r.done=false;return v}t.inflateReset=oe;t.inflateReset2=le;t.inflateResetKeep=se;t.inflateInit=ce;t.inflateInit2=fe;t.inflate=be;t.inflateEnd=me;t.inflateGetHeader=ge;t.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./inffast":34,"./inftrees":36}],36:[function(e,r,t){"use strict";var a=e("../utils/common");var n=15;var i=852;var s=592;var o=0;var l=1;var f=2;var c=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0];var u=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78];var h=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0];var d=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function v(e,r,t,p,b,m,g,E){var k=E.bits;var S=0;var w=0;var B=0,C=0;var _=0;var T=0;var x=0;var I=0;var A=0;var y=0;var R;var D;var O;var F;var P;var N=null;var L=0;var M;var U=new a.Buf16(n+1);var H=new a.Buf16(n+1);var W=null;var z=0;var V,X,G;for(S=0;S<=n;S++){U[S]=0}for(w=0;w<p;w++){U[r[t+w]]++}_=k;for(C=n;C>=1;C--){if(U[C]!==0){break}}if(_>C){_=C}if(C===0){b[m++]=1<<24|64<<16|0;b[m++]=1<<24|64<<16|0;E.bits=1;return 0}for(B=1;B<C;B++){if(U[B]!==0){break}}if(_<B){_=B}I=1;for(S=1;S<=n;S++){I<<=1;I-=U[S];if(I<0){return-1}}if(I>0&&(e===o||C!==1)){return-1}H[1]=0;for(S=1;S<n;S++){H[S+1]=H[S]+U[S]}for(w=0;w<p;w++){if(r[t+w]!==0){g[H[r[t+w]]++]=w}}if(e===o){N=W=g;M=19}else if(e===l){N=c;L-=257;W=u;z-=257;M=256}else{N=h;W=d;M=-1}y=0;w=0;S=B;P=m;T=_;x=0;O=-1;A=1<<_;F=A-1;if(e===l&&A>i||e===f&&A>s){return 1}var j=0;for(;;){j++;V=S-x;if(g[w]<M){X=0;G=g[w]}else if(g[w]>M){X=W[z+g[w]];G=N[L+g[w]]}else{X=32+64;G=0}R=1<<S-x;D=1<<T;B=D;do{D-=R;b[P+(y>>x)+D]=V<<24|X<<16|G|0}while(D!==0);R=1<<S-1;while(y&R){R>>=1}if(R!==0){y&=R-1;y+=R}else{y=0}w++;if(--U[S]===0){if(S===C){break}S=r[t+g[w]]}if(S>_&&(y&F)!==O){if(x===0){x=_}P+=B;T=S-x;I=1<<T;while(T+x<C){I-=U[T+x];if(I<=0){break}T++;I<<=1}A+=1<<T;if(e===l&&A>i||e===f&&A>s){return 1}O=y&F;b[O]=_<<24|T<<16|P-m|0}}if(y!==0){b[P+y]=S-x<<24|64<<16|0}E.bits=_;return 0}},{"../utils/common":27}],37:[function(e,r,t){"use strict";r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],38:[function(e,r,t){"use strict";var a=e("../utils/common");var n=4;var i=0;var s=1;var o=2;function l(e){var r=e.length;while(--r>=0){e[r]=0}}var f=0;var c=1;var u=2;var h=3;var d=258;var v=29;var p=256;var b=p+1+v;var m=30;var g=19;var E=2*b+1;var k=15;var S=16;var w=7;var B=256;var C=16;var _=17;var T=18;var x=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0];var I=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];var A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7];var y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];var R=512;var D=new Array((b+2)*2);l(D);var O=new Array(m*2);l(O);var F=new Array(R);l(F);var P=new Array(d-h+1);l(P);var N=new Array(v);l(N);var L=new Array(m);l(L);var M=function(e,r,t,a,n){this.static_tree=e;this.extra_bits=r;this.extra_base=t;this.elems=a;this.max_length=n;this.has_stree=e&&e.length};var U;var H;var W;var z=function(e,r){this.dyn_tree=e;this.max_code=0;this.stat_desc=r};function V(e){return e<256?F[e]:F[256+(e>>>7)]}function X(e,r){e.pending_buf[e.pending++]=r&255;e.pending_buf[e.pending++]=r>>>8&255}function G(e,r,t){if(e.bi_valid>S-t){e.bi_buf|=r<<e.bi_valid&65535;X(e,e.bi_buf);e.bi_buf=r>>S-e.bi_valid;e.bi_valid+=t-S}else{e.bi_buf|=r<<e.bi_valid&65535;e.bi_valid+=t}}function j(e,r,t){G(e,t[r*2],t[r*2+1])}function K(e,r){var t=0;do{t|=e&1;e>>>=1;t<<=1}while(--r>0);return t>>>1}function Y(e){if(e.bi_valid===16){X(e,e.bi_buf);e.bi_buf=0;e.bi_valid=0}else if(e.bi_valid>=8){e.pending_buf[e.pending++]=e.bi_buf&255;e.bi_buf>>=8;e.bi_valid-=8}}function $(e,r){var t=r.dyn_tree;var a=r.max_code;var n=r.stat_desc.static_tree;var i=r.stat_desc.has_stree;var s=r.stat_desc.extra_bits;var o=r.stat_desc.extra_base;var l=r.stat_desc.max_length;var f;var c,u;var h;var d;var v;var p=0;for(h=0;h<=k;h++){e.bl_count[h]=0}t[e.heap[e.heap_max]*2+1]=0;for(f=e.heap_max+1;f<E;f++){c=e.heap[f];h=t[t[c*2+1]*2+1]+1;if(h>l){h=l;p++}t[c*2+1]=h;if(c>a){continue}e.bl_count[h]++;d=0;if(c>=o){d=s[c-o]}v=t[c*2];e.opt_len+=v*(h+d);if(i){e.static_len+=v*(n[c*2+1]+d)}}if(p===0){return}do{h=l-1;while(e.bl_count[h]===0){h--}e.bl_count[h]--;e.bl_count[h+1]+=2;e.bl_count[l]--;p-=2}while(p>0);for(h=l;h!==0;h--){c=e.bl_count[h];while(c!==0){u=e.heap[--f];if(u>a){continue}if(t[u*2+1]!==h){e.opt_len+=(h-t[u*2+1])*t[u*2];t[u*2+1]=h}c--}}}function Z(e,r,t){var a=new Array(k+1);var n=0;var i;var s;for(i=1;i<=k;i++){a[i]=n=n+t[i-1]<<1}for(s=0;s<=r;s++){var o=e[s*2+1];if(o===0){continue}e[s*2]=K(a[o]++,o)}}function Q(){var e;var r;var t;var a;var n;var i=new Array(k+1);t=0;for(a=0;a<v-1;a++){N[a]=t;for(e=0;e<1<<x[a];e++){P[t++]=a}}P[t-1]=a;n=0;for(a=0;a<16;a++){L[a]=n;for(e=0;e<1<<I[a];e++){F[n++]=a}}n>>=7;for(;a<m;a++){L[a]=n<<7;for(e=0;e<1<<I[a]-7;e++){F[256+n++]=a}}for(r=0;r<=k;r++){i[r]=0}e=0;while(e<=143){D[e*2+1]=8;e++;i[8]++}while(e<=255){D[e*2+1]=9;e++;i[9]++}while(e<=279){D[e*2+1]=7;e++;i[7]++}while(e<=287){D[e*2+1]=8;e++;i[8]++}Z(D,b+1,i);for(e=0;e<m;e++){O[e*2+1]=5;O[e*2]=K(e,5)}U=new M(D,x,p+1,b,k);H=new M(O,I,0,m,k);W=new M(new Array(0),A,0,g,w)}function J(e){var r;for(r=0;r<b;r++){e.dyn_ltree[r*2]=0}for(r=0;r<m;r++){e.dyn_dtree[r*2]=0}for(r=0;r<g;r++){e.bl_tree[r*2]=0}e.dyn_ltree[B*2]=1;e.opt_len=e.static_len=0;e.last_lit=e.matches=0}function q(e){if(e.bi_valid>8){X(e,e.bi_buf)}else if(e.bi_valid>0){e.pending_buf[e.pending++]=e.bi_buf}e.bi_buf=0;e.bi_valid=0}function ee(e,r,t,n){q(e);if(n){X(e,t);X(e,~t)}a.arraySet(e.pending_buf,e.window,r,t,e.pending);e.pending+=t}function re(e,r,t,a){var n=r*2;var i=t*2;return e[n]<e[i]||e[n]===e[i]&&a[r]<=a[t]}function te(e,r,t){var a=e.heap[t];var n=t<<1;while(n<=e.heap_len){if(n<e.heap_len&&re(r,e.heap[n+1],e.heap[n],e.depth)){n++}if(re(r,a,e.heap[n],e.depth)){break}e.heap[t]=e.heap[n];t=n;n<<=1}e.heap[t]=a}function ae(e,r,t){var a;var n;var i=0;var s;var o;if(e.last_lit!==0){do{a=e.pending_buf[e.d_buf+i*2]<<8|e.pending_buf[e.d_buf+i*2+1];n=e.pending_buf[e.l_buf+i];i++;if(a===0){j(e,n,r)}else{s=P[n];j(e,s+p+1,r);o=x[s];if(o!==0){n-=N[s];G(e,n,o)}a--;s=V(a);j(e,s,t);o=I[s];if(o!==0){a-=L[s];G(e,a,o)}}}while(i<e.last_lit)}j(e,B,r)}function ne(e,r){var t=r.dyn_tree;var a=r.stat_desc.static_tree;var n=r.stat_desc.has_stree;var i=r.stat_desc.elems;var s,o;var l=-1;var f;e.heap_len=0;e.heap_max=E;for(s=0;s<i;s++){if(t[s*2]!==0){e.heap[++e.heap_len]=l=s;e.depth[s]=0}else{t[s*2+1]=0}}while(e.heap_len<2){f=e.heap[++e.heap_len]=l<2?++l:0;t[f*2]=1;e.depth[f]=0;e.opt_len--;if(n){e.static_len-=a[f*2+1]}}r.max_code=l;for(s=e.heap_len>>1;s>=1;s--){te(e,t,s)}f=i;do{s=e.heap[1];e.heap[1]=e.heap[e.heap_len--];te(e,t,1);o=e.heap[1];e.heap[--e.heap_max]=s;e.heap[--e.heap_max]=o;t[f*2]=t[s*2]+t[o*2];e.depth[f]=(e.depth[s]>=e.depth[o]?e.depth[s]:e.depth[o])+1;t[s*2+1]=t[o*2+1]=f;e.heap[1]=f++;te(e,t,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1];$(e,r);Z(t,l,e.bl_count)}function ie(e,r,t){var a;var n=-1;var i;var s=r[0*2+1];var o=0;var l=7;var f=4;if(s===0){l=138;f=3}r[(t+1)*2+1]=65535;for(a=0;a<=t;a++){i=s;s=r[(a+1)*2+1];if(++o<l&&i===s){continue}else if(o<f){e.bl_tree[i*2]+=o}else if(i!==0){if(i!==n){e.bl_tree[i*2]++}e.bl_tree[C*2]++}else if(o<=10){e.bl_tree[_*2]++}else{e.bl_tree[T*2]++}o=0;n=i;if(s===0){l=138;f=3}else if(i===s){l=6;f=3}else{l=7;f=4}}}function se(e,r,t){var a;var n=-1;var i;var s=r[0*2+1];var o=0;var l=7;var f=4;if(s===0){l=138;f=3}for(a=0;a<=t;a++){i=s;s=r[(a+1)*2+1];if(++o<l&&i===s){continue}else if(o<f){do{j(e,i,e.bl_tree)}while(--o!==0)}else if(i!==0){if(i!==n){j(e,i,e.bl_tree);o--}j(e,C,e.bl_tree);G(e,o-3,2)}else if(o<=10){j(e,_,e.bl_tree);G(e,o-3,3)}else{j(e,T,e.bl_tree);G(e,o-11,7)}o=0;n=i;if(s===0){l=138;f=3}else if(i===s){l=6;f=3}else{l=7;f=4}}}function oe(e){var r;ie(e,e.dyn_ltree,e.l_desc.max_code);ie(e,e.dyn_dtree,e.d_desc.max_code);ne(e,e.bl_desc);for(r=g-1;r>=3;r--){if(e.bl_tree[y[r]*2+1]!==0){break}}e.opt_len+=3*(r+1)+5+5+4;return r}function le(e,r,t,a){var n;G(e,r-257,5);G(e,t-1,5);G(e,a-4,4);for(n=0;n<a;n++){G(e,e.bl_tree[y[n]*2+1],3)}se(e,e.dyn_ltree,r-1);se(e,e.dyn_dtree,t-1)}function fe(e){var r=4093624447;var t;for(t=0;t<=31;t++,r>>>=1){if(r&1&&e.dyn_ltree[t*2]!==0){return i}}if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0){return s}for(t=32;t<p;t++){if(e.dyn_ltree[t*2]!==0){return s}}return i}var ce=false;function ue(e){if(!ce){Q();ce=true}e.l_desc=new z(e.dyn_ltree,U);e.d_desc=new z(e.dyn_dtree,H);e.bl_desc=new z(e.bl_tree,W);e.bi_buf=0;e.bi_valid=0;J(e)}function he(e,r,t,a){G(e,(f<<1)+(a?1:0),3);ee(e,r,t,true)}function de(e){G(e,c<<1,3);j(e,B,D);Y(e)}function ve(e,r,t,a){var i,s;var l=0;if(e.level>0){if(e.strm.data_type===o){e.strm.data_type=fe(e)}ne(e,e.l_desc);ne(e,e.d_desc);l=oe(e);i=e.opt_len+3+7>>>3;s=e.static_len+3+7>>>3;if(s<=i){i=s}}else{i=s=t+5}if(t+4<=i&&r!==-1){he(e,r,t,a)}else if(e.strategy===n||s===i){G(e,(c<<1)+(a?1:0),3);ae(e,D,O)}else{G(e,(u<<1)+(a?1:0),3);le(e,e.l_desc.max_code+1,e.d_desc.max_code+1,l+1);ae(e,e.dyn_ltree,e.dyn_dtree)}J(e);if(a){q(e)}}function pe(e,r,t){e.pending_buf[e.d_buf+e.last_lit*2]=r>>>8&255;e.pending_buf[e.d_buf+e.last_lit*2+1]=r&255;e.pending_buf[e.l_buf+e.last_lit]=t&255;e.last_lit++;if(r===0){e.dyn_ltree[t*2]++}else{e.matches++;r--;e.dyn_ltree[(P[t]+p+1)*2]++;e.dyn_dtree[V(r)*2]++}return e.last_lit===e.lit_bufsize-1}t._tr_init=ue;t._tr_stored_block=he;t._tr_flush_block=ve;t._tr_tally=pe;t._tr_align=de},{"../utils/common":27}],39:[function(e,r,t){"use strict";function a(){this.input=null;this.next_in=0;this.avail_in=0;this.total_in=0;this.output=null;this.next_out=0;this.avail_out=0;this.total_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0}r.exports=a},{}]},{},[9])(9)});var XLSX={};(function e(r){r.version="0.11.5";var t=1200;if(typeof module!=="undefined"&&typeof require!=="undefined"){if(typeof cptable==="undefined")global.cptable=undefined}function a(){n(1200)}var n=function(e){t=e};function i(e){var r=[];for(var t=0,a=e.length;t<a;++t)r[t]=e.charCodeAt(t);return r}function s(e){var r=[];for(var t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function o(e){var r=[];for(var t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var l=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);if(r==255&&t==254)return s(e.substr(2));if(r==254&&t==255)return o(e.substr(2));if(r==65279)return e.substr(1);return e};var f=function Op(e){return String.fromCharCode(e)};if(typeof cptable!=="undefined"){n=function(e){t=e};l=function(e){if(e.charCodeAt(0)===255&&e.charCodeAt(1)===254){return cptable.utils.decode(1200,i(e.substr(2)))}return e};f=function Fp(e){if(t===1200)return String.fromCharCode(e);return cptable.utils.decode(t,[e&255,e>>8])[0]}}var c=null;var u=true;var h=function Pp(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(r){var t="";var a,n,i,s,o,l,f;for(var c=0;c<r.length;){a=r.charCodeAt(c++);n=r.charCodeAt(c++);i=r.charCodeAt(c++);s=a>>2;o=(a&3)<<4|n>>4;l=(n&15)<<2|i>>6;f=i&63;if(isNaN(n)){l=f=64}else if(isNaN(i)){f=64}t+=e.charAt(s)+e.charAt(o)+e.charAt(l)+e.charAt(f)}return t},decode:function r(t){var a="";var n,i,s;var o,l,f,c;t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var u=0;u<t.length;){o=e.indexOf(t.charAt(u++));l=e.indexOf(t.charAt(u++));f=e.indexOf(t.charAt(u++));c=e.indexOf(t.charAt(u++));n=o<<2|l>>4;i=(l&15)<<4|f>>2;s=(f&3)<<6|c;a+=String.fromCharCode(n);if(f!=64){a+=String.fromCharCode(i)}if(c!=64){a+=String.fromCharCode(s)}}return a}}}();var d=typeof Buffer!=="undefined"&&typeof process!=="undefined"&&typeof process.versions!=="undefined"&&process.versions.node;function v(e){return new(d?Buffer:Array)(e)}function p(e){if(d)return new Buffer(e,"binary");return e.split("").map(function(e){return e.charCodeAt(0)&255})}var b=function(e){return[].concat.apply([],e)};var m=/\u0000/g,g=/[\u0001-\u0006]/;var E={};var k=function Np(e){e.version="0.10.0";function r(e){var r="",t=e.length-1;while(t>=0)r+=e.charAt(t--);return r}function t(e,r){var t="";while(t.length<r)t+=e;return t}function a(e,r){var a=""+e;return a.length>=r?a:t("0",r-a.length)+a}function n(e,r){var a=""+e;return a.length>=r?a:t(" ",r-a.length)+a}function i(e,r){var a=""+e;return a.length>=r?a:a+t(" ",r-a.length)}function s(e,r){var a=""+Math.round(e);return a.length>=r?a:t("0",r-a.length)+a}function o(e,r){var a=""+e;return a.length>=r?a:t("0",r-a.length)+a}var l=Math.pow(2,32);function f(e,r){if(e>l||e<-l)return s(e,r);var t=Math.round(e);return o(t,r)}function c(e,r){r=r||0;return e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var u=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]];var h=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function d(e){e[0]="General";e[1]="0";e[2]="0.00";e[3]="#,##0";e[4]="#,##0.00";e[9]="0%";e[10]="0.00%";e[11]="0.00E+00";e[12]="# ?/?";e[13]="# ??/??";e[14]="m/d/yy";e[15]="d-mmm-yy";e[16]="d-mmm";e[17]="mmm-yy";e[18]="h:mm AM/PM";e[19]="h:mm:ss AM/PM";e[20]="h:mm";e[21]="h:mm:ss";e[22]="m/d/yy h:mm";e[37]="#,##0 ;(#,##0)";e[38]="#,##0 ;[Red](#,##0)";e[39]="#,##0.00;(#,##0.00)";e[40]="#,##0.00;[Red](#,##0.00)";e[45]="mm:ss";e[46]="[h]:mm:ss";e[47]="mmss.0";e[48]="##0.0E+0";e[49]="@";e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "';e[65535]="General"}var v={};d(v);function p(e,r,t){var a=e<0?-1:1;var n=e*a;var i=0,s=1,o=0;var l=1,f=0,c=0;var u=Math.floor(n);while(f<r){u=Math.floor(n);o=u*s+i;c=u*f+l;if(n-u<5e-8)break;n=1/(n-u);i=s;s=o;l=f;f=c}if(c>r){if(f>r){c=l;o=i}else{c=f;o=s}}if(!t)return[0,a*o,c];var h=Math.floor(a*o/c);return[h,a*o-h*c,c]}function b(e,r,t){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),i=0;var s=[];var o={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6)o.u=0;if(r&&r.date1904)a+=1462;if(o.u>.9999){o.u=0;if(++n==86400){o.T=n=0;++a;++o.D}}if(a===60){s=t?[1317,10,29]:[1900,2,29];i=3}else if(a===0){s=t?[1317,8,29]:[1900,1,0];i=6}else{if(a>60)--a;var l=new Date(1900,0,1);l.setDate(l.getDate()+a-1);s=[l.getFullYear(),l.getMonth()+1,l.getDate()];i=l.getDay();if(a<60)i=(i+6)%7;if(t)i=C(l,s)}o.y=s[0];o.m=s[1];o.d=s[2];o.S=n%60;n=Math.floor(n/60);o.M=n%60;n=Math.floor(n/60);o.H=n;o.q=i;return o}e.parse_date_code=b;var m=new Date(1899,11,31,0,0,0);var g=m.getTime();var E=new Date(1900,2,1,0,0,0);function k(e,r){var t=e.getTime();if(r)t-=1461*24*60*60*1e3;else if(e>=E)t+=24*60*60*1e3;return(t-(g+(e.getTimezoneOffset()-m.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function S(e){return e.toString(10)}e._general_int=S;var w=function M(){var e=/\.(\d*[1-9])0+$/,r=/\.0*$/,t=/\.(\d*[1-9])0+/,a=/\.0*[Ee]/,n=/(E[+-])(\d)$/;function i(e){var r=e<0?12:11;var t=l(e.toFixed(12));if(t.length<=r)return t;t=e.toPrecision(10);if(t.length<=r)return t;return e.toExponential(5)}function s(r){var t=r.toFixed(11).replace(e,".$1");if(t.length>(r<0?12:11))t=r.toPrecision(6);return t}function o(e){for(var r=0;r!=e.length;++r)if((e.charCodeAt(r)|32)===101)return e.replace(t,".$1").replace(a,"E").replace("e","E").replace(n,"$10$2");return e}function l(t){return t.indexOf(".")>-1?t.replace(r,"").replace(e,".$1"):t}return function f(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;if(r>=-4&&r<=-1)t=e.toPrecision(10+r);else if(Math.abs(r)<=9)t=i(e);else if(r===10)t=e.toFixed(10).substr(0,12);else t=s(e);return l(o(t))}}();e._general_num=w;function B(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?S(e):w(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return N(14,k(e,r&&r.date1904),r);}throw new Error("unsupported value in General format: "+e)}e._general=B;function C(){return 0}function _(e,r,t,n){var i="",s=0,o=0,l=t.y,f,c=0;switch(e){case 98:l=t.y+543;case 121:switch(r.length){case 1:;case 2:f=l%100;c=2;break;default:f=l%1e4;c=4;break;}break;case 109:switch(r.length){case 1:;case 2:f=t.m;c=r.length;break;case 3:return h[t.m-1][1];case 5:return h[t.m-1][0];default:return h[t.m-1][2];}break;case 100:switch(r.length){case 1:;case 2:f=t.d;c=r.length;break;case 3:return u[t.q][0];default:return u[t.q][1];}break;case 104:switch(r.length){case 1:;case 2:f=1+(t.H+11)%12;c=r.length;break;default:throw"bad hour format: "+r;}break;case 72:switch(r.length){case 1:;case 2:f=t.H;c=r.length;break;default:throw"bad hour format: "+r;}break;case 77:switch(r.length){case 1:;case 2:f=t.M;c=r.length;break;default:throw"bad minute format: "+r;}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;if(t.u===0&&(r=="s"||r=="ss"))return a(t.S,r.length);if(n>=2)o=n===3?1e3:100;else o=n===1?10:1;s=Math.round(o*(t.S+t.u));if(s>=60*o)s=0;if(r==="s")return s===0?"0":""+s/o;i=a(s,2+n);if(r==="ss")return i.substr(0,2);return"."+i.substr(2,r.length-1);case 90:switch(r){case"[h]":;case"[hh]":f=t.D*24+t.H;break;case"[m]":;case"[mm]":f=(t.D*24+t.H)*60+t.M;break;case"[s]":;case"[ss]":f=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r;}c=r.length===3?1:2;break;case 101:f=l;c=1;}if(c>0)return a(f,c);else return""}function T(e){var r=3;if(e.length<=r)return e;var t=e.length%r,a=e.substr(0,t);for(;t!=e.length;t+=r)a+=(a.length>0?",":"")+e.substr(t,r);return a}var x=function U(){var e=/%/g;function s(r,a,n){var i=a.replace(e,""),s=a.length-i.length;return x(r,i,n*Math.pow(10,2*s))+t("%",s)}function o(e,r,t){var a=r.length-1;while(r.charCodeAt(a-1)===44)--a;return x(e,r.substr(0,a),t/Math.pow(10,3*(r.length-a)))}function l(e,r){var t;var a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";else if(r<0)return"-"+l(e,-r);var n=e.indexOf(".");if(n===-1)n=e.indexOf("E");var i=Math.floor(Math.log(r)*Math.LOG10E)%n;if(i<0)i+=n;t=(r/Math.pow(10,i)).toPrecision(a+1+(n+i)%n);if(t.indexOf("e")===-1){var s=Math.floor(Math.log(r)*Math.LOG10E);if(t.indexOf(".")===-1)t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+i);else t+="E+"+(s-i);while(t.substr(0,2)==="0."){t=t.charAt(0)+t.substr(2,n)+"."+t.substr(2+n);t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.")}t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,r,t,a){return r+t+a.substr(0,(n+i)%n)+"."+a.substr(i)+"E"})}else t=r.toExponential(a);if(e.match(/E\+00$/)&&t.match(/e[+-]\d$/))t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1);if(e.match(/E\-/)&&t.match(/e\+/))t=t.replace(/e\+/,"e");return t.replace("e","E")}var c=/# (\?+)( ?)\/( ?)(\d+)/;function u(e,r,i){var s=parseInt(e[4],10),o=Math.round(r*s),l=Math.floor(o/s);var f=o-l*s,c=s;return i+(l===0?"":""+l)+" "+(f===0?t(" ",e[1].length+1+e[4].length):n(f,e[1].length)+e[2]+"/"+e[3]+a(c,e[4].length))}function h(e,r,a){return a+(r===0?"":""+r)+t(" ",e[1].length+2+e[4].length)}var d=/^#*0*\.([0#]+)/;var v=/\).*[0#]/;var b=/\(###\) ###\\?-####/;function m(e){var r="",t;for(var a=0;a!=e.length;++a)switch(t=e.charCodeAt(a)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t);}return r}function g(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function E(e,r){if(r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length){return 0}return Math.round((e-Math.floor(e))*Math.pow(10,r))}function k(e,r){if(r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length){return 1}return 0}function S(e){if(e<2147483647&&e>-2147483648)return""+(e>=0?e|0:e-1|0);return""+Math.floor(e)}function w(e,h,B){if(e.charCodeAt(0)===40&&!h.match(v)){var C=h.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");if(B>=0)return w("n",C,B);return"("+w("n",C,-B)+")"}if(h.charCodeAt(h.length-1)===44)return o(e,h,B);if(h.indexOf("%")!==-1)return s(e,h,B);if(h.indexOf("E")!==-1)return l(h,B);if(h.charCodeAt(0)===36)return"$"+w(e,h.substr(h.charAt(1)==" "?2:1),B);var _;var I,A,y,R=Math.abs(B),D=B<0?"-":"";if(h.match(/^00+$/))return D+f(R,h.length);if(h.match(/^[#?]+$/)){_=f(B,0);if(_==="0")_="";return _.length>h.length?_:m(h.substr(0,h.length-_.length))+_}if(I=h.match(c))return u(I,R,D);if(h.match(/^#+0+$/))return D+f(R,h.length-h.indexOf("0"));if(I=h.match(d)){_=g(B,I[1].length).replace(/^([^\.]+)$/,"$1."+m(I[1])).replace(/\.$/,"."+m(I[1])).replace(/\.(\d*)$/,function(e,r){return"."+r+t("0",m(I[1]).length-r.length)});return h.indexOf("0.")!==-1?_:_.replace(/^0\./,".")}h=h.replace(/^#+([0.])/,"$1");if(I=h.match(/^(0*)\.(#*)$/)){return D+g(R,I[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,I[1].length?"0.":".")}if(I=h.match(/^#{1,3},##0(\.?)$/))return D+T(f(R,0));if(I=h.match(/^#,##0\.([#0]*0)$/)){return B<0?"-"+w(e,h,-B):T(""+(Math.floor(B)+k(B,I[1].length)))+"."+a(E(B,I[1].length),I[1].length)}if(I=h.match(/^#,#*,#0/))return w(e,h.replace(/^#,#*,/,""),B);if(I=h.match(/^([0#]+)(\\?-([0#]+))+$/)){_=r(w(e,h.replace(/[\\-]/g,""),B));A=0;return r(r(h.replace(/\\/g,"")).replace(/[0#]/g,function(e){return A<_.length?_.charAt(A++):e==="0"?"0":""}))}if(h.match(b)){_=w(e,"##########",B);return"("+_.substr(0,3)+") "+_.substr(3,3)+"-"+_.substr(6)}var O="";if(I=h.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/)){A=Math.min(I[4].length,7);y=p(R,Math.pow(10,A)-1,false);_=""+D;O=x("n",I[1],y[1]);if(O.charAt(O.length-1)==" ")O=O.substr(0,O.length-1)+"0";_+=O+I[2]+"/"+I[3];O=i(y[2],A);if(O.length<I[4].length)O=m(I[4].substr(I[4].length-O.length))+O;_+=O;return _}if(I=h.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/)){A=Math.min(Math.max(I[1].length,I[4].length),7);y=p(R,Math.pow(10,A)-1,true);return D+(y[0]||(y[1]?"":"0"))+" "+(y[1]?n(y[1],A)+I[2]+"/"+I[3]+i(y[2],A):t(" ",2*A+1+I[2].length+I[3].length))}if(I=h.match(/^[#0?]+$/)){_=f(B,0);if(h.length<=_.length)return _;return m(h.substr(0,h.length-_.length))+_}if(I=h.match(/^([#0?]+)\.([#0]+)$/)){_=""+B.toFixed(Math.min(I[2].length,10)).replace(/([^0])0+$/,"$1");A=_.indexOf(".");var F=h.indexOf(".")-A,P=h.length-_.length-F;return m(h.substr(0,F)+_+h.substr(h.length-P))}if(I=h.match(/^00,000\.([#0]*0)$/)){A=E(B,I[1].length);return B<0?"-"+w(e,h,-B):T(S(B)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?a(0,3-e.length):"")+e})+"."+a(A,I[1].length)}switch(h){case"###,##0.00":return w(e,"#,##0.00",B);case"###,###":;case"##,###":;case"#,###":var N=T(f(R,0));return N!=="0"?D+N:"";case"###,###.00":return w(e,"###,##0.00",B).replace(/^0\./,".");case"#,###.00":return w(e,"#,##0.00",B).replace(/^0\./,".");default:;}throw new Error("unsupported format |"+h+"|")}function B(e,r,t){var a=r.length-1;while(r.charCodeAt(a-1)===44)--a;return x(e,r.substr(0,a),t/Math.pow(10,3*(r.length-a)))}function C(r,a,n){var i=a.replace(e,""),s=a.length-i.length;return x(r,i,n*Math.pow(10,2*s))+t("%",s)}function _(e,r){var t;var a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";else if(r<0)return"-"+_(e,-r);var n=e.indexOf(".");if(n===-1)n=e.indexOf("E");var i=Math.floor(Math.log(r)*Math.LOG10E)%n;if(i<0)i+=n;t=(r/Math.pow(10,i)).toPrecision(a+1+(n+i)%n);if(!t.match(/[Ee]/)){var s=Math.floor(Math.log(r)*Math.LOG10E);if(t.indexOf(".")===-1)t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+i);else t+="E+"+(s-i);t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,r,t,a){return r+t+a.substr(0,(n+i)%n)+"."+a.substr(i)+"E"})}else t=r.toExponential(a);if(e.match(/E\+00$/)&&t.match(/e[+-]\d$/))t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1);if(e.match(/E\-/)&&t.match(/e\+/))t=t.replace(/e\+/,"e");return t.replace("e","E")}function I(e,s,o){if(e.charCodeAt(0)===40&&!s.match(v)){var l=s.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");if(o>=0)return I("n",l,o);return"("+I("n",l,-o)+")"}if(s.charCodeAt(s.length-1)===44)return B(e,s,o);if(s.indexOf("%")!==-1)return C(e,s,o);if(s.indexOf("E")!==-1)return _(s,o);if(s.charCodeAt(0)===36)return"$"+I(e,s.substr(s.charAt(1)==" "?2:1),o);var f;var u,g,E,k=Math.abs(o),S=o<0?"-":"";if(s.match(/^00+$/))return S+a(k,s.length);if(s.match(/^[#?]+$/)){f=""+o;if(o===0)f="";return f.length>s.length?f:m(s.substr(0,s.length-f.length))+f}if(u=s.match(c))return h(u,k,S);if(s.match(/^#+0+$/))return S+a(k,s.length-s.indexOf("0"));if(u=s.match(d)){f=(""+o).replace(/^([^\.]+)$/,"$1."+m(u[1])).replace(/\.$/,"."+m(u[1]));f=f.replace(/\.(\d*)$/,function(e,r){return"."+r+t("0",m(u[1]).length-r.length)});return s.indexOf("0.")!==-1?f:f.replace(/^0\./,".")}s=s.replace(/^#+([0.])/,"$1");if(u=s.match(/^(0*)\.(#*)$/)){return S+(""+k).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,u[1].length?"0.":".")}if(u=s.match(/^#{1,3},##0(\.?)$/))return S+T("